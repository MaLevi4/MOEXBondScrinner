import unittest
import json
import datetime
from MOEXBondScrinner import BondsMOEXFilter


class BondsMOEXFilterTest(unittest.TestCase):
    def test_safe_get_time1(self):
        # No key in object
        input_object = {}
        result = BondsMOEXFilter._safe_get_time(input_object, 'amortdate')
        self.assertIs(result, None)

    def test_safe_get_time2(self):
        # Incorrect time format
        input_object = {"amortdate": "07.09.2017", "faceunit": "RUB", "value": 125}
        result = BondsMOEXFilter._safe_get_time(input_object, 'amortdate')
        self.assertIs(result, None)

    def test_safe_get_time3(self):
        # Everything is OK for amortdate
        input_object = {"amortdate": "2020-09-07", "faceunit": "RUB", "value": 125}
        result = BondsMOEXFilter._safe_get_time(input_object, 'amortdate')
        self.assertEqual(result, datetime.datetime(2020, 9, 7))

    def test_check_not_offer_true(self):
        # Simple bond example
        bond = json.loads('{"SECID": "RU000A0JNYN1", "ISIN": "RU000A0JNYN1", "SHORTNAME": "\u041c\u0413\u043e\u044048-\u043e\u0431", "SECNAME": "\u0413\u043e\u0440.\u041e\u0431\u043b.\u0417\u0430\u0439\u043c \u041c\u043e\u0441\u043a\u0432\u044b 48 \u0432.", "PREVPRICE": 100.36, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-06-11", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 16.11, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "2067", "amortizations": [{"amortdate": "2022-06-11", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2007-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2007-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2009-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2009-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2010-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2010-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2011-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2011-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2013-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2013-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2014-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2014-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2015-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2015-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-06-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2017-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2017-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2018-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2018-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2019-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2019-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-06-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2021-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2021-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2022-06-11", "faceunit": "RUB", "value": 29.92}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 126, "NUMTRADES": 28}, {"TRADEDATE": "2021-03-04", "VOLUME": 124, "NUMTRADES": 19}, {"TRADEDATE": "2021-03-05", "VOLUME": 291, "NUMTRADES": 13}, {"TRADEDATE": "2021-03-09", "VOLUME": 186, "NUMTRADES": 34}, {"TRADEDATE": "2021-03-10", "VOLUME": 114, "NUMTRADES": 21}, {"TRADEDATE": "2021-03-11", "VOLUME": 28, "NUMTRADES": 15}, {"TRADEDATE": "2021-03-12", "VOLUME": 13, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-15", "VOLUME": 1235, "NUMTRADES": 82}, {"TRADEDATE": "2021-03-16", "VOLUME": 1992, "NUMTRADES": 41}, {"TRADEDATE": "2021-03-17", "VOLUME": 24, "NUMTRADES": 11}]}')
        result = BondsMOEXFilter.check_not_offer(bond)
        self.assertIs(result, True)

    def test_check_not_offer_false(self):
        # Simple bond example with offer date
        bond = json.loads('{"SECID": "RU000A0JRDY3", "ISIN": "RU000A0JRDY3", "SHORTNAME": "\u0414\u041e\u041c.\u0420\u042418\u043e\u0431", "SECNAME": "\u0414\u041e\u041c.\u0420\u0424 (\u0410\u041e) \u043e\u0431\u043b. \u0441\u0435\u0440.\u041018", "PREVPRICE": 105, "LOTSIZE": 1, "FACEVALUE": 700, "MATDATE": "2023-07-15", "OFFERDATE": "2021-04-19", "FACEUNIT": "SUR", "ACCRUEDINT": 5.74, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "1380", "amortizations": [{"amortdate": "2020-07-15", "faceunit": "RUB", "value": 300}, {"amortdate": "2021-07-15", "faceunit": "RUB", "value": 200}, {"amortdate": "2022-07-15", "faceunit": "RUB", "value": 200}, {"amortdate": "2023-07-15", "faceunit": "RUB", "value": 300}], "coupons": [{"coupondate": "2011-04-15", "faceunit": "RUB", "value": 2.19}, {"coupondate": "2011-07-15", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2011-10-15", "faceunit": "RUB", "value": 20.16}, {"coupondate": "2012-01-15", "faceunit": "RUB", "value": 20.16}, {"coupondate": "2012-04-15", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2012-07-15", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2012-10-15", "faceunit": "RUB", "value": 20.16}, {"coupondate": "2013-01-15", "faceunit": "RUB", "value": 20.16}, {"coupondate": "2013-04-15", "faceunit": "RUB", "value": 19.73}, {"coupondate": "2013-07-15", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2013-10-15", "faceunit": "RUB", "value": 20.16}, {"coupondate": "2014-01-15", "faceunit": "RUB", "value": 20.16}, {"coupondate": "2014-04-15", "faceunit": "RUB", "value": 19.73}, {"coupondate": "2014-07-15", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2014-10-15", "faceunit": "RUB", "value": 20.16}, {"coupondate": "2015-01-15", "faceunit": "RUB", "value": 20.16}, {"coupondate": "2015-04-15", "faceunit": "RUB", "value": 19.73}, {"coupondate": "2015-07-15", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2015-10-15", "faceunit": "RUB", "value": 20.16}, {"coupondate": "2016-01-15", "faceunit": "RUB", "value": 20.16}, {"coupondate": "2016-04-15", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2016-07-15", "faceunit": "RUB", "value": 25.68}, {"coupondate": "2016-10-15", "faceunit": "RUB", "value": 25.96}, {"coupondate": "2017-01-15", "faceunit": "RUB", "value": 25.96}, {"coupondate": "2017-04-15", "faceunit": "RUB", "value": 25.4}, {"coupondate": "2017-07-15", "faceunit": "RUB", "value": 25.68}, {"coupondate": "2017-10-15", "faceunit": "RUB", "value": 25.96}, {"coupondate": "2018-01-15", "faceunit": "RUB", "value": 25.96}, {"coupondate": "2018-04-15", "faceunit": "RUB", "value": 25.4}, {"coupondate": "2018-07-15", "faceunit": "RUB", "value": 16.7}, {"coupondate": "2018-10-15", "faceunit": "RUB", "value": 16.89}, {"coupondate": "2019-01-15", "faceunit": "RUB", "value": 16.89}, {"coupondate": "2019-04-15", "faceunit": "RUB", "value": 16.52}, {"coupondate": "2019-07-15", "faceunit": "RUB", "value": 16.7}, {"coupondate": "2019-10-15", "faceunit": "RUB", "value": 0.13}, {"coupondate": "2020-01-15", "faceunit": "RUB", "value": 0.13}, {"coupondate": "2020-04-15", "faceunit": "RUB", "value": 0.12}, {"coupondate": "2020-07-15", "faceunit": "RUB", "value": 0.12}, {"coupondate": "2020-10-15", "faceunit": "RUB", "value": 7.76}, {"coupondate": "2021-01-15", "faceunit": "RUB", "value": 0.09}, {"coupondate": "2021-04-15", "faceunit": "RUB", "value": 8.2}, {"coupondate": "2021-07-15", "faceunit": "RUB", "value": null}, {"coupondate": "2021-10-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-01-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-04-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-07-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-10-15", "faceunit": "RUB", "value": null}, {"coupondate": "2023-01-15", "faceunit": "RUB", "value": null}, {"coupondate": "2023-04-15", "faceunit": "RUB", "value": null}, {"coupondate": "2023-07-15", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "0000-00-00", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2016-04-18", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2018-04-17", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-04-17", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2021-04-19", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-16", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}')
        result = BondsMOEXFilter.check_not_offer(bond)
        self.assertIs(result, False)

    def test_check_not_offer_none(self):
        # bond example without 'OFFERDATE' key
        bond = json.loads('{"SECID": "RU000A0JNYN1", "ISIN": "RU000A0JNYN1", "SHORTNAME": "\u041c\u0413\u043e\u044048-\u043e\u0431", "SECNAME": "\u0413\u043e\u0440.\u041e\u0431\u043b.\u0417\u0430\u0439\u043c \u041c\u043e\u0441\u043a\u0432\u044b 48 \u0432.", "PREVPRICE": 100.36, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-06-11", "FACEUNIT": "SUR", "ACCRUEDINT": 16.11, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "2067", "amortizations": [{"amortdate": "2022-06-11", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2007-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2007-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2009-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2009-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2010-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2010-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2011-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2011-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2013-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2013-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2014-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2014-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2015-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2015-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-06-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2017-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2017-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2018-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2018-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2019-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2019-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-06-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2021-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2021-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2022-06-11", "faceunit": "RUB", "value": 29.92}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 126, "NUMTRADES": 28}, {"TRADEDATE": "2021-03-04", "VOLUME": 124, "NUMTRADES": 19}, {"TRADEDATE": "2021-03-05", "VOLUME": 291, "NUMTRADES": 13}, {"TRADEDATE": "2021-03-09", "VOLUME": 186, "NUMTRADES": 34}, {"TRADEDATE": "2021-03-10", "VOLUME": 114, "NUMTRADES": 21}, {"TRADEDATE": "2021-03-11", "VOLUME": 28, "NUMTRADES": 15}, {"TRADEDATE": "2021-03-12", "VOLUME": 13, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-15", "VOLUME": 1235, "NUMTRADES": 82}, {"TRADEDATE": "2021-03-16", "VOLUME": 1992, "NUMTRADES": 41}, {"TRADEDATE": "2021-03-17", "VOLUME": 24, "NUMTRADES": 11}]}')
        result = BondsMOEXFilter.check_not_offer(bond)
        self.assertIs(result, None)

    def test_check_not_amortization_true(self):
        # Simple bond example without amortization
        bond = json.loads('{"SECID": "RU000A0JNYN1", "ISIN": "RU000A0JNYN1", "SHORTNAME": "\u041c\u0413\u043e\u044048-\u043e\u0431", "SECNAME": "\u0413\u043e\u0440.\u041e\u0431\u043b.\u0417\u0430\u0439\u043c \u041c\u043e\u0441\u043a\u0432\u044b 48 \u0432.", "PREVPRICE": 100.36, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-06-11", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 16.11, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "2067", "amortizations": [{"amortdate": "2022-06-11", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2007-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2007-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2009-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2009-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2010-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2010-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2011-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2011-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2013-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2013-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2014-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2014-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2015-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2015-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-06-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2017-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2017-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2018-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2018-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2019-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2019-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-06-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2021-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2021-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2022-06-11", "faceunit": "RUB", "value": 29.92}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 126, "NUMTRADES": 28}, {"TRADEDATE": "2021-03-04", "VOLUME": 124, "NUMTRADES": 19}, {"TRADEDATE": "2021-03-05", "VOLUME": 291, "NUMTRADES": 13}, {"TRADEDATE": "2021-03-09", "VOLUME": 186, "NUMTRADES": 34}, {"TRADEDATE": "2021-03-10", "VOLUME": 114, "NUMTRADES": 21}, {"TRADEDATE": "2021-03-11", "VOLUME": 28, "NUMTRADES": 15}, {"TRADEDATE": "2021-03-12", "VOLUME": 13, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-15", "VOLUME": 1235, "NUMTRADES": 82}, {"TRADEDATE": "2021-03-16", "VOLUME": 1992, "NUMTRADES": 41}, {"TRADEDATE": "2021-03-17", "VOLUME": 24, "NUMTRADES": 11}]}')
        result = BondsMOEXFilter.check_not_amortization(bond)
        self.assertIs(result, True)

    def test_check_not_amortization_true_last_step(self):
        # Bond example with amortization but all amortization payments already passed
        bond = json.loads('{"SECID": "RU000A0JVRM0", "ISIN": "RU000A0JVRM0", "SHORTNAME": "\u0411\u0430\u043b\u0442\u041b\u0438\u0437\u0411\u041e2", "SECNAME": "\u0411\u0430\u043b\u0442\u0438\u0439\u0441\u043a\u0438\u0439 \u043b\u0438\u0437\u0438\u043d\u0433 \u041e\u041e\u041e \u0411\u041e-02", "PREVPRICE": 100.25, "LOTSIZE": 1, "FACEVALUE": 500, "MATDATE": "2021-09-02", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 1.64, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "67656", "amortizations": [{"amortdate": "2017-09-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2017-12-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2018-03-08", "faceunit": "RUB", "value": 125}, {"amortdate": "2018-06-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2021-09-02", "faceunit": "RUB", "value": 500}], "coupons": [{"coupondate": "2015-12-10", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-03-10", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-06-09", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-09-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-12-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-03-09", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-06-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-09-07", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-12-07", "faceunit": "RUB", "value": 29.45}, {"coupondate": "2018-03-08", "faceunit": "RUB", "value": 25.24}, {"coupondate": "2018-06-07", "faceunit": "RUB", "value": 21.04}, {"coupondate": "2018-09-06", "faceunit": "RUB", "value": 16.83}, {"coupondate": "2018-12-06", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-03-07", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-06-06", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-09-05", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-12-05", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-03-05", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-06-04", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-09-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-12-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-03-04", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-06-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-09-02", "faceunit": "RUB", "value": 9.97}], "offers": [{"offerdate": "2018-09-06", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430/\u041f\u043e\u0433\u0430\u0448\u0435\u043d\u0438\u0435(\u043e\u0442\u043c\u0435\u043d\u0435\u043d\u043e)"}, {"offerdate": "2019-09-10", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 407, "NUMTRADES": 5}, {"TRADEDATE": "2021-03-09", "VOLUME": 4, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-10", "VOLUME": 90, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-11", "VOLUME": 55, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 8, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}')
        result = BondsMOEXFilter.check_not_amortization(bond)
        self.assertIs(result, True)

    def test_check_not_amortization_false_enforce(self):
        # Bond example with amortization but all amortization payments already passed
        bond = json.loads('{"SECID": "RU000A0JVRM0", "ISIN": "RU000A0JVRM0", "SHORTNAME": "\u0411\u0430\u043b\u0442\u041b\u0438\u0437\u0411\u041e2", "SECNAME": "\u0411\u0430\u043b\u0442\u0438\u0439\u0441\u043a\u0438\u0439 \u043b\u0438\u0437\u0438\u043d\u0433 \u041e\u041e\u041e \u0411\u041e-02", "PREVPRICE": 100.25, "LOTSIZE": 1, "FACEVALUE": 500, "MATDATE": "2021-09-02", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 1.64, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "67656", "amortizations": [{"amortdate": "2017-09-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2017-12-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2018-03-08", "faceunit": "RUB", "value": 125}, {"amortdate": "2018-06-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2021-09-02", "faceunit": "RUB", "value": 500}], "coupons": [{"coupondate": "2015-12-10", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-03-10", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-06-09", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-09-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-12-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-03-09", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-06-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-09-07", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-12-07", "faceunit": "RUB", "value": 29.45}, {"coupondate": "2018-03-08", "faceunit": "RUB", "value": 25.24}, {"coupondate": "2018-06-07", "faceunit": "RUB", "value": 21.04}, {"coupondate": "2018-09-06", "faceunit": "RUB", "value": 16.83}, {"coupondate": "2018-12-06", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-03-07", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-06-06", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-09-05", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-12-05", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-03-05", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-06-04", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-09-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-12-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-03-04", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-06-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-09-02", "faceunit": "RUB", "value": 9.97}], "offers": [{"offerdate": "2018-09-06", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430/\u041f\u043e\u0433\u0430\u0448\u0435\u043d\u0438\u0435(\u043e\u0442\u043c\u0435\u043d\u0435\u043d\u043e)"}, {"offerdate": "2019-09-10", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 407, "NUMTRADES": 5}, {"TRADEDATE": "2021-03-09", "VOLUME": 4, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-10", "VOLUME": 90, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-11", "VOLUME": 55, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 8, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}')
        result = BondsMOEXFilter.check_not_amortization(bond, ignore_last_step=False)
        self.assertIs(result, False)

    def test_check_not_amortization_false(self):
        # Simple bond example with amortization
        bond = json.loads('{"SECID": "RU000A0JX215", "ISIN": "RU000A0JX215", "SHORTNAME": "\u0425\u041c\u0410\u041e 10", "SECNAME": "\u0425\u041c\u0410\u041e-\u042e\u0433\u0440\u044b \u043e\u0431. 35001", "PREVPRICE": 105.2, "LOTSIZE": 1, "FACEVALUE": 700, "MATDATE": "2023-12-18", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 15.44, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "1365", "amortizations": [{"amortdate": "2020-12-21", "faceunit": "RUB", "value": 300}, {"amortdate": "2021-12-20", "faceunit": "RUB", "value": 300}, {"amortdate": "2022-12-19", "faceunit": "RUB", "value": 300}, {"amortdate": "2023-12-18", "faceunit": "RUB", "value": 100}], "coupons": [{"coupondate": "2017-03-27", "faceunit": "RUB", "value": 24.57}, {"coupondate": "2017-06-26", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2017-09-25", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2017-12-25", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2018-03-26", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2018-06-25", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2018-09-24", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2018-12-24", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2019-03-25", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2019-06-24", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2019-09-23", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2019-12-23", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2020-03-23", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2020-06-22", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2020-09-21", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2020-12-21", "faceunit": "RUB", "value": 22.81}, {"coupondate": "2021-03-22", "faceunit": "RUB", "value": 15.97}, {"coupondate": "2021-06-21", "faceunit": "RUB", "value": 15.97}, {"coupondate": "2021-09-20", "faceunit": "RUB", "value": 15.97}, {"coupondate": "2021-12-20", "faceunit": "RUB", "value": 15.97}, {"coupondate": "2022-03-21", "faceunit": "RUB", "value": 9.12}, {"coupondate": "2022-06-20", "faceunit": "RUB", "value": 9.12}, {"coupondate": "2022-09-19", "faceunit": "RUB", "value": 9.12}, {"coupondate": "2022-12-19", "faceunit": "RUB", "value": 9.12}, {"coupondate": "2023-03-20", "faceunit": "RUB", "value": 2.28}, {"coupondate": "2023-06-19", "faceunit": "RUB", "value": 2.28}, {"coupondate": "2023-09-18", "faceunit": "RUB", "value": 2.28}, {"coupondate": "2023-12-18", "faceunit": "RUB", "value": 2.28}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 2003, "NUMTRADES": 7}, {"TRADEDATE": "2021-03-05", "VOLUME": 12, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-09", "VOLUME": 32, "NUMTRADES": 7}, {"TRADEDATE": "2021-03-10", "VOLUME": 10, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-11", "VOLUME": 4, "NUMTRADES": 2}, {"TRADEDATE": "2021-03-12", "VOLUME": 3, "NUMTRADES": 2}, {"TRADEDATE": "2021-03-15", "VOLUME": 7, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-16", "VOLUME": 8, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-17", "VOLUME": 1, "NUMTRADES": 1}]}')
        result = BondsMOEXFilter.check_not_amortization(bond)
        self.assertIs(result, False)

    def test_check_not_amortization_none(self):
        # Simple bond example without 'amortizations' key
        bond = json.loads('{"SECID": "RU000A0JNYN1", "ISIN": "RU000A0JNYN1", "SHORTNAME": "\u041c\u0413\u043e\u044048-\u043e\u0431", "SECNAME": "\u0413\u043e\u0440.\u041e\u0431\u043b.\u0417\u0430\u0439\u043c \u041c\u043e\u0441\u043a\u0432\u044b 48 \u0432.", "PREVPRICE": 100.36, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-06-11", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 16.11, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "2067", "coupons": [{"coupondate": "2007-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2007-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2009-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2009-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2010-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2010-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2011-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2011-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2013-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2013-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2014-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2014-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2015-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2015-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-06-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2017-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2017-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2018-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2018-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2019-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2019-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-06-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2021-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2021-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2022-06-11", "faceunit": "RUB", "value": 29.92}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 126, "NUMTRADES": 28}, {"TRADEDATE": "2021-03-04", "VOLUME": 124, "NUMTRADES": 19}, {"TRADEDATE": "2021-03-05", "VOLUME": 291, "NUMTRADES": 13}, {"TRADEDATE": "2021-03-09", "VOLUME": 186, "NUMTRADES": 34}, {"TRADEDATE": "2021-03-10", "VOLUME": 114, "NUMTRADES": 21}, {"TRADEDATE": "2021-03-11", "VOLUME": 28, "NUMTRADES": 15}, {"TRADEDATE": "2021-03-12", "VOLUME": 13, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-15", "VOLUME": 1235, "NUMTRADES": 82}, {"TRADEDATE": "2021-03-16", "VOLUME": 1992, "NUMTRADES": 41}, {"TRADEDATE": "2021-03-17", "VOLUME": 24, "NUMTRADES": 11}]}')
        result = BondsMOEXFilter.check_not_amortization(bond)
        self.assertIs(result, None)

    def test_check_not_amortization_none2(self):
        # Simple bond example with error in keys in 'amortizations' objects (incorrect time format for example)
        bond = json.loads('{"SECID": "RU000A0JVRM0", "ISIN": "RU000A0JVRM0", "SHORTNAME": "\u0411\u0430\u043b\u0442\u041b\u0438\u0437\u0411\u041e2", "SECNAME": "\u0411\u0430\u043b\u0442\u0438\u0439\u0441\u043a\u0438\u0439 \u043b\u0438\u0437\u0438\u043d\u0433 \u041e\u041e\u041e \u0411\u041e-02", "PREVPRICE": 100.25, "LOTSIZE": 1, "FACEVALUE": 500, "MATDATE": "2021-09-02", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 1.64, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "67656", "amortizations": [{"amortdate": "07.09.2017", "faceunit": "RUB", "value": 125}, {"amortdate": "2017-12-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2018-03-08", "faceunit": "RUB", "value": 125}, {"amortdate": "2018-06-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2021-09-02", "faceunit": "RUB", "value": 500}], "coupons": [{"coupondate": "2015-12-10", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-03-10", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-06-09", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-09-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-12-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-03-09", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-06-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-09-07", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-12-07", "faceunit": "RUB", "value": 29.45}, {"coupondate": "2018-03-08", "faceunit": "RUB", "value": 25.24}, {"coupondate": "2018-06-07", "faceunit": "RUB", "value": 21.04}, {"coupondate": "2018-09-06", "faceunit": "RUB", "value": 16.83}, {"coupondate": "2018-12-06", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-03-07", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-06-06", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-09-05", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-12-05", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-03-05", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-06-04", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-09-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-12-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-03-04", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-06-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-09-02", "faceunit": "RUB", "value": 9.97}], "offers": [{"offerdate": "2018-09-06", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430/\u041f\u043e\u0433\u0430\u0448\u0435\u043d\u0438\u0435(\u043e\u0442\u043c\u0435\u043d\u0435\u043d\u043e)"}, {"offerdate": "2019-09-10", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 407, "NUMTRADES": 5}, {"TRADEDATE": "2021-03-09", "VOLUME": 4, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-10", "VOLUME": 90, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-11", "VOLUME": 55, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 8, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}')
        result = BondsMOEXFilter.check_not_amortization(bond)
        self.assertIs(result, None)

    def test_filter_bonds_by_offer1(self):
        # Empty list
        input_bond_list = []
        target_bond_list = []
        output_bond_list = BondsMOEXFilter.filter_bonds_by_offer(input_bond_list)
        self.assertEqual(output_bond_list, target_bond_list)

    def test_filter_bonds_by_offer2(self):
        # List with no offer
        input_bond_list = json.loads('[{"SECID": "RU000A0JNYN1", "ISIN": "RU000A0JNYN1", "SHORTNAME": "\u041c\u0413\u043e\u044048-\u043e\u0431", "SECNAME": "\u0413\u043e\u0440.\u041e\u0431\u043b.\u0417\u0430\u0439\u043c \u041c\u043e\u0441\u043a\u0432\u044b 48 \u0432.", "PREVPRICE": 100.36, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-06-11", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 16.11, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "2067", "amortizations": [{"amortdate": "2022-06-11", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2007-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2007-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2009-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2009-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2010-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2010-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2011-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2011-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2013-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2013-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2014-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2014-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2015-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2015-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-06-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2017-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2017-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2018-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2018-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2019-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2019-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-06-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2021-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2021-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2022-06-11", "faceunit": "RUB", "value": 29.92}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 126, "NUMTRADES": 28}, {"TRADEDATE": "2021-03-04", "VOLUME": 124, "NUMTRADES": 19}, {"TRADEDATE": "2021-03-05", "VOLUME": 291, "NUMTRADES": 13}, {"TRADEDATE": "2021-03-09", "VOLUME": 186, "NUMTRADES": 34}, {"TRADEDATE": "2021-03-10", "VOLUME": 114, "NUMTRADES": 21}, {"TRADEDATE": "2021-03-11", "VOLUME": 28, "NUMTRADES": 15}, {"TRADEDATE": "2021-03-12", "VOLUME": 13, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-15", "VOLUME": 1235, "NUMTRADES": 82}, {"TRADEDATE": "2021-03-16", "VOLUME": 1992, "NUMTRADES": 41}, {"TRADEDATE": "2021-03-17", "VOLUME": 24, "NUMTRADES": 11}]}, {"SECID": "RU000A0JQ8V9", "ISIN": "RU000A0JQ8V9", "SHORTNAME": "\u041c\u0435\u0447\u0435\u043b  4\u043e\u0431", "SECNAME": "\u041c\u0435\u0447\u0435\u043b \u041f\u0410\u041e 04 \u043e\u0431\u043b.", "PREVPRICE": 252.06, "LOTSIZE": 1, "FACEVALUE": 100, "MATDATE": "2021-07-15", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 1.38, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "1483", "amortizations": [{"amortdate": "2016-08-11", "faceunit": "RUB", "value": 35}, {"amortdate": "2016-10-20", "faceunit": "RUB", "value": 35}, {"amortdate": "2017-01-19", "faceunit": "RUB", "value": 40}, {"amortdate": "2017-04-20", "faceunit": "RUB", "value": 40}, {"amortdate": "2017-07-20", "faceunit": "RUB", "value": 50}, {"amortdate": "2017-10-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-01-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-04-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-07-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-10-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-01-17", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-04-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-07-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-10-17", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-01-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-04-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-07-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-10-15", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-01-14", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-04-15", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-07-15", "faceunit": "RUB", "value": 50}], "coupons": [{"coupondate": "2009-10-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-01-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-04-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-07-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-10-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-01-27", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-04-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-07-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-10-27", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-01-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-04-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-07-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-10-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-01-24", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-04-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-07-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-10-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-01-23", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-04-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-07-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-10-23", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2015-01-22", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2015-04-23", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2015-07-23", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2015-10-22", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-01-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-04-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-07-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-10-20", "faceunit": "RUB", "value": 31.54}, {"coupondate": "2017-01-19", "faceunit": "RUB", "value": 28.98}, {"coupondate": "2017-04-20", "faceunit": "RUB", "value": 28.29}, {"coupondate": "2017-07-20", "faceunit": "RUB", "value": 26.75}, {"coupondate": "2017-10-19", "faceunit": "RUB", "value": 23.44}, {"coupondate": "2018-01-18", "faceunit": "RUB", "value": 21.5}, {"coupondate": "2018-04-19", "faceunit": "RUB", "value": 19.42}, {"coupondate": "2018-07-19", "faceunit": "RUB", "value": 17.62}, {"coupondate": "2018-10-18", "faceunit": "RUB", "value": 15.52}, {"coupondate": "2019-01-17", "faceunit": "RUB", "value": 14.4}, {"coupondate": "2019-04-18", "faceunit": "RUB", "value": 13.24}, {"coupondate": "2019-07-18", "faceunit": "RUB", "value": 11.92}, {"coupondate": "2019-10-17", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-01-16", "faceunit": "RUB", "value": 8.51}, {"coupondate": "2020-04-16", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2020-07-16", "faceunit": "RUB", "value": 5.77}, {"coupondate": "2020-10-15", "faceunit": "RUB", "value": 3.99}, {"coupondate": "2021-01-14", "faceunit": "RUB", "value": 2.95}, {"coupondate": "2021-04-15", "faceunit": "RUB", "value": 1.96}, {"coupondate": "2021-07-15", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2012-07-30", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2013-07-29", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2014-01-27", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2014-07-28", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2015-01-26", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2015-07-27", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 19, "NUMTRADES": 3}]}, {"SECID": "RU000A0JQAL8", "ISIN": "RU000A0JQAL8", "SHORTNAME": "\u0414\u041e\u041c.\u0420\u042414\u043e\u0431", "SECNAME": "\u0414\u041e\u041c.\u0420\u0424 (\u0410\u041e) \u043e\u0431\u043b. \u0441\u0435\u0440. \u041014", "PREVPRICE": 104.7, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2023-05-15", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 22.93, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "1380", "amortizations": [{"amortdate": "2023-05-15", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2010-05-15", "faceunit": "RUB", "value": 94.75}, {"coupondate": "2010-11-15", "faceunit": "RUB", "value": 52.93}, {"coupondate": "2011-05-15", "faceunit": "RUB", "value": 50.83}, {"coupondate": "2011-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2012-05-15", "faceunit": "RUB", "value": 53.6}, {"coupondate": "2012-11-15", "faceunit": "RUB", "value": 52.93}, {"coupondate": "2013-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2013-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2014-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2014-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2015-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2015-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2016-05-15", "faceunit": "RUB", "value": 53.6}, {"coupondate": "2016-11-15", "faceunit": "RUB", "value": 68.05}, {"coupondate": "2017-05-15", "faceunit": "RUB", "value": 61.99}, {"coupondate": "2017-11-15", "faceunit": "RUB", "value": 59.23}, {"coupondate": "2018-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2018-11-15", "faceunit": "RUB", "value": 49.15}, {"coupondate": "2019-05-15", "faceunit": "RUB", "value": 49.59}, {"coupondate": "2019-11-15", "faceunit": "RUB", "value": 51.67}, {"coupondate": "2020-05-15", "faceunit": "RUB", "value": 44.88}, {"coupondate": "2020-11-15", "faceunit": "RUB", "value": 40.33}, {"coupondate": "2021-05-15", "faceunit": "RUB", "value": 33.47}, {"coupondate": "2021-11-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-05-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-11-15", "faceunit": "RUB", "value": null}, {"coupondate": "2023-05-15", "faceunit": "RUB", "value": null}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}, {"SECID": "RU000A0JRJL7", "ISIN": "RU000A0JRJL7", "SHORTNAME": "\u0417\u0421\u0414 02", "SECNAME": "\u0417\u0430\u043f\u0430\u0434.\u0441\u043a\u043e\u0440.\u0434\u0438\u0430\u043c\u0435\u0442\u0440 \u0410\u041e \u043e\u0431.02", "PREVPRICE": 130, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2031-05-13", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 32.89, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "2423", "amortizations": [{"amortdate": "2031-05-13", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2011-12-06", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2012-06-05", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2012-12-04", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2013-06-04", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2013-12-03", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2014-06-03", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2014-12-02", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2015-06-02", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2015-12-01", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2016-05-31", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2016-11-29", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2017-05-30", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2017-11-28", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2018-05-29", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2018-11-27", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2019-05-28", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2019-11-26", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2020-05-26", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2020-11-24", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2021-05-25", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2021-11-23", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2022-05-24", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2022-11-22", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2023-05-23", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2023-11-21", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2024-05-21", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2024-11-19", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2025-05-20", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2025-11-18", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2026-05-19", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2026-11-17", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2027-05-18", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2027-11-16", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2028-05-16", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2028-11-14", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2029-05-15", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2029-11-13", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2030-05-14", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2030-11-12", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2031-05-13", "faceunit": "RUB", "value": 52.06}], "offers": [{"offerdate": "2016-06-02", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 3, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 3, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-15", "VOLUME": 6, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}]')
        target_bond_list = json.loads('[{"SECID": "RU000A0JNYN1", "ISIN": "RU000A0JNYN1", "SHORTNAME": "\u041c\u0413\u043e\u044048-\u043e\u0431", "SECNAME": "\u0413\u043e\u0440.\u041e\u0431\u043b.\u0417\u0430\u0439\u043c \u041c\u043e\u0441\u043a\u0432\u044b 48 \u0432.", "PREVPRICE": 100.36, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-06-11", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 16.11, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "2067", "amortizations": [{"amortdate": "2022-06-11", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2007-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2007-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2009-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2009-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2010-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2010-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2011-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2011-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2013-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2013-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2014-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2014-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2015-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2015-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-06-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2017-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2017-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2018-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2018-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2019-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2019-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-06-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2021-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2021-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2022-06-11", "faceunit": "RUB", "value": 29.92}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 126, "NUMTRADES": 28}, {"TRADEDATE": "2021-03-04", "VOLUME": 124, "NUMTRADES": 19}, {"TRADEDATE": "2021-03-05", "VOLUME": 291, "NUMTRADES": 13}, {"TRADEDATE": "2021-03-09", "VOLUME": 186, "NUMTRADES": 34}, {"TRADEDATE": "2021-03-10", "VOLUME": 114, "NUMTRADES": 21}, {"TRADEDATE": "2021-03-11", "VOLUME": 28, "NUMTRADES": 15}, {"TRADEDATE": "2021-03-12", "VOLUME": 13, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-15", "VOLUME": 1235, "NUMTRADES": 82}, {"TRADEDATE": "2021-03-16", "VOLUME": 1992, "NUMTRADES": 41}, {"TRADEDATE": "2021-03-17", "VOLUME": 24, "NUMTRADES": 11}]}, {"SECID": "RU000A0JQ8V9", "ISIN": "RU000A0JQ8V9", "SHORTNAME": "\u041c\u0435\u0447\u0435\u043b  4\u043e\u0431", "SECNAME": "\u041c\u0435\u0447\u0435\u043b \u041f\u0410\u041e 04 \u043e\u0431\u043b.", "PREVPRICE": 252.06, "LOTSIZE": 1, "FACEVALUE": 100, "MATDATE": "2021-07-15", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 1.38, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "1483", "amortizations": [{"amortdate": "2016-08-11", "faceunit": "RUB", "value": 35}, {"amortdate": "2016-10-20", "faceunit": "RUB", "value": 35}, {"amortdate": "2017-01-19", "faceunit": "RUB", "value": 40}, {"amortdate": "2017-04-20", "faceunit": "RUB", "value": 40}, {"amortdate": "2017-07-20", "faceunit": "RUB", "value": 50}, {"amortdate": "2017-10-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-01-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-04-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-07-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-10-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-01-17", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-04-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-07-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-10-17", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-01-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-04-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-07-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-10-15", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-01-14", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-04-15", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-07-15", "faceunit": "RUB", "value": 50}], "coupons": [{"coupondate": "2009-10-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-01-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-04-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-07-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-10-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-01-27", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-04-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-07-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-10-27", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-01-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-04-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-07-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-10-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-01-24", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-04-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-07-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-10-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-01-23", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-04-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-07-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-10-23", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2015-01-22", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2015-04-23", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2015-07-23", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2015-10-22", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-01-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-04-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-07-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-10-20", "faceunit": "RUB", "value": 31.54}, {"coupondate": "2017-01-19", "faceunit": "RUB", "value": 28.98}, {"coupondate": "2017-04-20", "faceunit": "RUB", "value": 28.29}, {"coupondate": "2017-07-20", "faceunit": "RUB", "value": 26.75}, {"coupondate": "2017-10-19", "faceunit": "RUB", "value": 23.44}, {"coupondate": "2018-01-18", "faceunit": "RUB", "value": 21.5}, {"coupondate": "2018-04-19", "faceunit": "RUB", "value": 19.42}, {"coupondate": "2018-07-19", "faceunit": "RUB", "value": 17.62}, {"coupondate": "2018-10-18", "faceunit": "RUB", "value": 15.52}, {"coupondate": "2019-01-17", "faceunit": "RUB", "value": 14.4}, {"coupondate": "2019-04-18", "faceunit": "RUB", "value": 13.24}, {"coupondate": "2019-07-18", "faceunit": "RUB", "value": 11.92}, {"coupondate": "2019-10-17", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-01-16", "faceunit": "RUB", "value": 8.51}, {"coupondate": "2020-04-16", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2020-07-16", "faceunit": "RUB", "value": 5.77}, {"coupondate": "2020-10-15", "faceunit": "RUB", "value": 3.99}, {"coupondate": "2021-01-14", "faceunit": "RUB", "value": 2.95}, {"coupondate": "2021-04-15", "faceunit": "RUB", "value": 1.96}, {"coupondate": "2021-07-15", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2012-07-30", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2013-07-29", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2014-01-27", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2014-07-28", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2015-01-26", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2015-07-27", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 19, "NUMTRADES": 3}]}, {"SECID": "RU000A0JQAL8", "ISIN": "RU000A0JQAL8", "SHORTNAME": "\u0414\u041e\u041c.\u0420\u042414\u043e\u0431", "SECNAME": "\u0414\u041e\u041c.\u0420\u0424 (\u0410\u041e) \u043e\u0431\u043b. \u0441\u0435\u0440. \u041014", "PREVPRICE": 104.7, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2023-05-15", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 22.93, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "1380", "amortizations": [{"amortdate": "2023-05-15", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2010-05-15", "faceunit": "RUB", "value": 94.75}, {"coupondate": "2010-11-15", "faceunit": "RUB", "value": 52.93}, {"coupondate": "2011-05-15", "faceunit": "RUB", "value": 50.83}, {"coupondate": "2011-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2012-05-15", "faceunit": "RUB", "value": 53.6}, {"coupondate": "2012-11-15", "faceunit": "RUB", "value": 52.93}, {"coupondate": "2013-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2013-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2014-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2014-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2015-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2015-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2016-05-15", "faceunit": "RUB", "value": 53.6}, {"coupondate": "2016-11-15", "faceunit": "RUB", "value": 68.05}, {"coupondate": "2017-05-15", "faceunit": "RUB", "value": 61.99}, {"coupondate": "2017-11-15", "faceunit": "RUB", "value": 59.23}, {"coupondate": "2018-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2018-11-15", "faceunit": "RUB", "value": 49.15}, {"coupondate": "2019-05-15", "faceunit": "RUB", "value": 49.59}, {"coupondate": "2019-11-15", "faceunit": "RUB", "value": 51.67}, {"coupondate": "2020-05-15", "faceunit": "RUB", "value": 44.88}, {"coupondate": "2020-11-15", "faceunit": "RUB", "value": 40.33}, {"coupondate": "2021-05-15", "faceunit": "RUB", "value": 33.47}, {"coupondate": "2021-11-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-05-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-11-15", "faceunit": "RUB", "value": null}, {"coupondate": "2023-05-15", "faceunit": "RUB", "value": null}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}, {"SECID": "RU000A0JRJL7", "ISIN": "RU000A0JRJL7", "SHORTNAME": "\u0417\u0421\u0414 02", "SECNAME": "\u0417\u0430\u043f\u0430\u0434.\u0441\u043a\u043e\u0440.\u0434\u0438\u0430\u043c\u0435\u0442\u0440 \u0410\u041e \u043e\u0431.02", "PREVPRICE": 130, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2031-05-13", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 32.89, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "2423", "amortizations": [{"amortdate": "2031-05-13", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2011-12-06", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2012-06-05", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2012-12-04", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2013-06-04", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2013-12-03", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2014-06-03", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2014-12-02", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2015-06-02", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2015-12-01", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2016-05-31", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2016-11-29", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2017-05-30", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2017-11-28", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2018-05-29", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2018-11-27", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2019-05-28", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2019-11-26", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2020-05-26", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2020-11-24", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2021-05-25", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2021-11-23", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2022-05-24", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2022-11-22", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2023-05-23", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2023-11-21", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2024-05-21", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2024-11-19", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2025-05-20", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2025-11-18", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2026-05-19", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2026-11-17", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2027-05-18", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2027-11-16", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2028-05-16", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2028-11-14", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2029-05-15", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2029-11-13", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2030-05-14", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2030-11-12", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2031-05-13", "faceunit": "RUB", "value": 52.06}], "offers": [{"offerdate": "2016-06-02", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 3, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 3, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-15", "VOLUME": 6, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}]')
        output_bond_list = BondsMOEXFilter.filter_bonds_by_offer(input_bond_list)
        self.assertEqual(output_bond_list, target_bond_list)

    def test_filter_bonds_by_offer3(self):
        # List with 2 offer
        input_bond_list = json.loads('[{"SECID": "RU000A0JNYN1", "ISIN": "RU000A0JNYN1", "SHORTNAME": "\u041c\u0413\u043e\u044048-\u043e\u0431", "SECNAME": "\u0413\u043e\u0440.\u041e\u0431\u043b.\u0417\u0430\u0439\u043c \u041c\u043e\u0441\u043a\u0432\u044b 48 \u0432.", "PREVPRICE": 100.36, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-06-11", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 16.11, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "2067", "amortizations": [{"amortdate": "2022-06-11", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2007-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2007-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2009-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2009-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2010-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2010-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2011-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2011-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2013-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2013-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2014-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2014-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2015-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2015-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-06-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2017-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2017-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2018-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2018-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2019-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2019-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-06-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2021-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2021-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2022-06-11", "faceunit": "RUB", "value": 29.92}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 126, "NUMTRADES": 28}, {"TRADEDATE": "2021-03-04", "VOLUME": 124, "NUMTRADES": 19}, {"TRADEDATE": "2021-03-05", "VOLUME": 291, "NUMTRADES": 13}, {"TRADEDATE": "2021-03-09", "VOLUME": 186, "NUMTRADES": 34}, {"TRADEDATE": "2021-03-10", "VOLUME": 114, "NUMTRADES": 21}, {"TRADEDATE": "2021-03-11", "VOLUME": 28, "NUMTRADES": 15}, {"TRADEDATE": "2021-03-12", "VOLUME": 13, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-15", "VOLUME": 1235, "NUMTRADES": 82}, {"TRADEDATE": "2021-03-16", "VOLUME": 1992, "NUMTRADES": 41}, {"TRADEDATE": "2021-03-17", "VOLUME": 24, "NUMTRADES": 11}]}, {"SECID": "RU000A0JQ8V9", "ISIN": "RU000A0JQ8V9", "SHORTNAME": "\u041c\u0435\u0447\u0435\u043b  4\u043e\u0431", "SECNAME": "\u041c\u0435\u0447\u0435\u043b \u041f\u0410\u041e 04 \u043e\u0431\u043b.", "PREVPRICE": 252.06, "LOTSIZE": 1, "FACEVALUE": 100, "MATDATE": "2021-07-15", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 1.38, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "1483", "amortizations": [{"amortdate": "2016-08-11", "faceunit": "RUB", "value": 35}, {"amortdate": "2016-10-20", "faceunit": "RUB", "value": 35}, {"amortdate": "2017-01-19", "faceunit": "RUB", "value": 40}, {"amortdate": "2017-04-20", "faceunit": "RUB", "value": 40}, {"amortdate": "2017-07-20", "faceunit": "RUB", "value": 50}, {"amortdate": "2017-10-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-01-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-04-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-07-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-10-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-01-17", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-04-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-07-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-10-17", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-01-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-04-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-07-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-10-15", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-01-14", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-04-15", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-07-15", "faceunit": "RUB", "value": 50}], "coupons": [{"coupondate": "2009-10-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-01-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-04-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-07-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-10-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-01-27", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-04-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-07-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-10-27", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-01-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-04-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-07-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-10-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-01-24", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-04-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-07-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-10-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-01-23", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-04-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-07-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-10-23", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2015-01-22", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2015-04-23", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2015-07-23", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2015-10-22", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-01-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-04-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-07-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-10-20", "faceunit": "RUB", "value": 31.54}, {"coupondate": "2017-01-19", "faceunit": "RUB", "value": 28.98}, {"coupondate": "2017-04-20", "faceunit": "RUB", "value": 28.29}, {"coupondate": "2017-07-20", "faceunit": "RUB", "value": 26.75}, {"coupondate": "2017-10-19", "faceunit": "RUB", "value": 23.44}, {"coupondate": "2018-01-18", "faceunit": "RUB", "value": 21.5}, {"coupondate": "2018-04-19", "faceunit": "RUB", "value": 19.42}, {"coupondate": "2018-07-19", "faceunit": "RUB", "value": 17.62}, {"coupondate": "2018-10-18", "faceunit": "RUB", "value": 15.52}, {"coupondate": "2019-01-17", "faceunit": "RUB", "value": 14.4}, {"coupondate": "2019-04-18", "faceunit": "RUB", "value": 13.24}, {"coupondate": "2019-07-18", "faceunit": "RUB", "value": 11.92}, {"coupondate": "2019-10-17", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-01-16", "faceunit": "RUB", "value": 8.51}, {"coupondate": "2020-04-16", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2020-07-16", "faceunit": "RUB", "value": 5.77}, {"coupondate": "2020-10-15", "faceunit": "RUB", "value": 3.99}, {"coupondate": "2021-01-14", "faceunit": "RUB", "value": 2.95}, {"coupondate": "2021-04-15", "faceunit": "RUB", "value": 1.96}, {"coupondate": "2021-07-15", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2012-07-30", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2013-07-29", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2014-01-27", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2014-07-28", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2015-01-26", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2015-07-27", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 19, "NUMTRADES": 3}]}, {"SECID": "RU000A100YF3", "ISIN": "RU000A100YF3", "SHORTNAME": "\u041c\u0415\u0422\u0410\u041b\u0418\u041d\u041103", "SECNAME": "\u041c\u0415\u0422\u0410\u041b\u041b\u041e\u0418\u041d\u0412\u0415\u0421\u0422 \u0411\u041e-03", "PREVPRICE": 101, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2029-10-10", "OFFERDATE": "2025-04-21", "FACEUNIT": "SUR", "ACCRUEDINT": 29.19, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "2539", "amortizations": [{"amortdate": "2029-10-10", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-04-22", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2020-10-21", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2021-04-21", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2021-10-20", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2022-04-20", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2022-10-19", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2023-04-19", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2023-10-18", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2024-04-17", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2024-10-16", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2025-04-16", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2025-10-15", "faceunit": "RUB", "value": null}, {"coupondate": "2026-04-15", "faceunit": "RUB", "value": null}, {"coupondate": "2026-10-14", "faceunit": "RUB", "value": null}, {"coupondate": "2027-04-14", "faceunit": "RUB", "value": null}, {"coupondate": "2027-10-13", "faceunit": "RUB", "value": null}, {"coupondate": "2028-04-12", "faceunit": "RUB", "value": null}, {"coupondate": "2028-10-11", "faceunit": "RUB", "value": null}, {"coupondate": "2029-04-11", "faceunit": "RUB", "value": null}, {"coupondate": "2029-10-10", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2025-04-21", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 347, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 1471, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-09", "VOLUME": 34, "NUMTRADES": 5}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 15, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-17", "VOLUME": 10, "NUMTRADES": 1}]}, {"SECID": "RU000A0JQAL8", "ISIN": "RU000A0JQAL8", "SHORTNAME": "\u0414\u041e\u041c.\u0420\u042414\u043e\u0431", "SECNAME": "\u0414\u041e\u041c.\u0420\u0424 (\u0410\u041e) \u043e\u0431\u043b. \u0441\u0435\u0440. \u041014", "PREVPRICE": 104.7, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2023-05-15", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 22.93, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "1380", "amortizations": [{"amortdate": "2023-05-15", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2010-05-15", "faceunit": "RUB", "value": 94.75}, {"coupondate": "2010-11-15", "faceunit": "RUB", "value": 52.93}, {"coupondate": "2011-05-15", "faceunit": "RUB", "value": 50.83}, {"coupondate": "2011-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2012-05-15", "faceunit": "RUB", "value": 53.6}, {"coupondate": "2012-11-15", "faceunit": "RUB", "value": 52.93}, {"coupondate": "2013-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2013-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2014-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2014-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2015-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2015-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2016-05-15", "faceunit": "RUB", "value": 53.6}, {"coupondate": "2016-11-15", "faceunit": "RUB", "value": 68.05}, {"coupondate": "2017-05-15", "faceunit": "RUB", "value": 61.99}, {"coupondate": "2017-11-15", "faceunit": "RUB", "value": 59.23}, {"coupondate": "2018-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2018-11-15", "faceunit": "RUB", "value": 49.15}, {"coupondate": "2019-05-15", "faceunit": "RUB", "value": 49.59}, {"coupondate": "2019-11-15", "faceunit": "RUB", "value": 51.67}, {"coupondate": "2020-05-15", "faceunit": "RUB", "value": 44.88}, {"coupondate": "2020-11-15", "faceunit": "RUB", "value": 40.33}, {"coupondate": "2021-05-15", "faceunit": "RUB", "value": 33.47}, {"coupondate": "2021-11-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-05-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-11-15", "faceunit": "RUB", "value": null}, {"coupondate": "2023-05-15", "faceunit": "RUB", "value": null}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}, {"SECID": "RU000A0JRJL7", "ISIN": "RU000A0JRJL7", "SHORTNAME": "\u0417\u0421\u0414 02", "SECNAME": "\u0417\u0430\u043f\u0430\u0434.\u0441\u043a\u043e\u0440.\u0434\u0438\u0430\u043c\u0435\u0442\u0440 \u0410\u041e \u043e\u0431.02", "PREVPRICE": 130, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2031-05-13", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 32.89, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "2423", "amortizations": [{"amortdate": "2031-05-13", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2011-12-06", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2012-06-05", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2012-12-04", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2013-06-04", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2013-12-03", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2014-06-03", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2014-12-02", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2015-06-02", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2015-12-01", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2016-05-31", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2016-11-29", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2017-05-30", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2017-11-28", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2018-05-29", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2018-11-27", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2019-05-28", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2019-11-26", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2020-05-26", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2020-11-24", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2021-05-25", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2021-11-23", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2022-05-24", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2022-11-22", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2023-05-23", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2023-11-21", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2024-05-21", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2024-11-19", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2025-05-20", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2025-11-18", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2026-05-19", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2026-11-17", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2027-05-18", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2027-11-16", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2028-05-16", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2028-11-14", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2029-05-15", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2029-11-13", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2030-05-14", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2030-11-12", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2031-05-13", "faceunit": "RUB", "value": 52.06}], "offers": [{"offerdate": "2016-06-02", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 3, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 3, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-15", "VOLUME": 6, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}, {"SECID": "RU000A100Y50", "ISIN": "RU000A100Y50", "SHORTNAME": "\u0421\u0423\u042d\u041a-\u04241P4R", "SECNAME": "\u0421\u0423\u042d\u041a-\u0424\u0438\u043d\u0430\u043d\u0441 001\u0420-04R", "PREVPRICE": 103.03, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2029-10-08", "OFFERDATE": "2023-10-19", "FACEUNIT": "SUR", "ACCRUEDINT": 30.61, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "2337", "amortizations": [{"amortdate": "2029-10-08", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-04-20", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2020-10-19", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2021-04-19", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2021-10-18", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2022-04-18", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2022-10-17", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2023-04-17", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2023-10-16", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2024-04-15", "faceunit": "RUB", "value": null}, {"coupondate": "2024-10-14", "faceunit": "RUB", "value": null}, {"coupondate": "2025-04-14", "faceunit": "RUB", "value": null}, {"coupondate": "2025-10-13", "faceunit": "RUB", "value": null}, {"coupondate": "2026-04-13", "faceunit": "RUB", "value": null}, {"coupondate": "2026-10-12", "faceunit": "RUB", "value": null}, {"coupondate": "2027-04-12", "faceunit": "RUB", "value": null}, {"coupondate": "2027-10-11", "faceunit": "RUB", "value": null}, {"coupondate": "2028-04-10", "faceunit": "RUB", "value": null}, {"coupondate": "2028-10-09", "faceunit": "RUB", "value": null}, {"coupondate": "2029-04-09", "faceunit": "RUB", "value": null}, {"coupondate": "2029-10-08", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2023-10-19", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 3, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-09", "VOLUME": 2, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-16", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}]')
        target_bond_list = json.loads('[{"SECID": "RU000A0JNYN1", "ISIN": "RU000A0JNYN1", "SHORTNAME": "\u041c\u0413\u043e\u044048-\u043e\u0431", "SECNAME": "\u0413\u043e\u0440.\u041e\u0431\u043b.\u0417\u0430\u0439\u043c \u041c\u043e\u0441\u043a\u0432\u044b 48 \u0432.", "PREVPRICE": 100.36, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-06-11", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 16.11, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "2067", "amortizations": [{"amortdate": "2022-06-11", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2007-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2007-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2009-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2009-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2010-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2010-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2011-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2011-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2013-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2013-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2014-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2014-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2015-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2015-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-06-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2017-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2017-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2018-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2018-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2019-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2019-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-06-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2021-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2021-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2022-06-11", "faceunit": "RUB", "value": 29.92}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 126, "NUMTRADES": 28}, {"TRADEDATE": "2021-03-04", "VOLUME": 124, "NUMTRADES": 19}, {"TRADEDATE": "2021-03-05", "VOLUME": 291, "NUMTRADES": 13}, {"TRADEDATE": "2021-03-09", "VOLUME": 186, "NUMTRADES": 34}, {"TRADEDATE": "2021-03-10", "VOLUME": 114, "NUMTRADES": 21}, {"TRADEDATE": "2021-03-11", "VOLUME": 28, "NUMTRADES": 15}, {"TRADEDATE": "2021-03-12", "VOLUME": 13, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-15", "VOLUME": 1235, "NUMTRADES": 82}, {"TRADEDATE": "2021-03-16", "VOLUME": 1992, "NUMTRADES": 41}, {"TRADEDATE": "2021-03-17", "VOLUME": 24, "NUMTRADES": 11}]}, {"SECID": "RU000A0JQ8V9", "ISIN": "RU000A0JQ8V9", "SHORTNAME": "\u041c\u0435\u0447\u0435\u043b  4\u043e\u0431", "SECNAME": "\u041c\u0435\u0447\u0435\u043b \u041f\u0410\u041e 04 \u043e\u0431\u043b.", "PREVPRICE": 252.06, "LOTSIZE": 1, "FACEVALUE": 100, "MATDATE": "2021-07-15", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 1.38, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "1483", "amortizations": [{"amortdate": "2016-08-11", "faceunit": "RUB", "value": 35}, {"amortdate": "2016-10-20", "faceunit": "RUB", "value": 35}, {"amortdate": "2017-01-19", "faceunit": "RUB", "value": 40}, {"amortdate": "2017-04-20", "faceunit": "RUB", "value": 40}, {"amortdate": "2017-07-20", "faceunit": "RUB", "value": 50}, {"amortdate": "2017-10-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-01-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-04-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-07-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-10-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-01-17", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-04-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-07-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-10-17", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-01-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-04-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-07-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-10-15", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-01-14", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-04-15", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-07-15", "faceunit": "RUB", "value": 50}], "coupons": [{"coupondate": "2009-10-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-01-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-04-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-07-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-10-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-01-27", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-04-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-07-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-10-27", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-01-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-04-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-07-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-10-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-01-24", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-04-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-07-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-10-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-01-23", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-04-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-07-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-10-23", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2015-01-22", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2015-04-23", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2015-07-23", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2015-10-22", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-01-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-04-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-07-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-10-20", "faceunit": "RUB", "value": 31.54}, {"coupondate": "2017-01-19", "faceunit": "RUB", "value": 28.98}, {"coupondate": "2017-04-20", "faceunit": "RUB", "value": 28.29}, {"coupondate": "2017-07-20", "faceunit": "RUB", "value": 26.75}, {"coupondate": "2017-10-19", "faceunit": "RUB", "value": 23.44}, {"coupondate": "2018-01-18", "faceunit": "RUB", "value": 21.5}, {"coupondate": "2018-04-19", "faceunit": "RUB", "value": 19.42}, {"coupondate": "2018-07-19", "faceunit": "RUB", "value": 17.62}, {"coupondate": "2018-10-18", "faceunit": "RUB", "value": 15.52}, {"coupondate": "2019-01-17", "faceunit": "RUB", "value": 14.4}, {"coupondate": "2019-04-18", "faceunit": "RUB", "value": 13.24}, {"coupondate": "2019-07-18", "faceunit": "RUB", "value": 11.92}, {"coupondate": "2019-10-17", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-01-16", "faceunit": "RUB", "value": 8.51}, {"coupondate": "2020-04-16", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2020-07-16", "faceunit": "RUB", "value": 5.77}, {"coupondate": "2020-10-15", "faceunit": "RUB", "value": 3.99}, {"coupondate": "2021-01-14", "faceunit": "RUB", "value": 2.95}, {"coupondate": "2021-04-15", "faceunit": "RUB", "value": 1.96}, {"coupondate": "2021-07-15", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2012-07-30", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2013-07-29", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2014-01-27", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2014-07-28", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2015-01-26", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2015-07-27", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 19, "NUMTRADES": 3}]}, {"SECID": "RU000A0JQAL8", "ISIN": "RU000A0JQAL8", "SHORTNAME": "\u0414\u041e\u041c.\u0420\u042414\u043e\u0431", "SECNAME": "\u0414\u041e\u041c.\u0420\u0424 (\u0410\u041e) \u043e\u0431\u043b. \u0441\u0435\u0440. \u041014", "PREVPRICE": 104.7, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2023-05-15", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 22.93, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "1380", "amortizations": [{"amortdate": "2023-05-15", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2010-05-15", "faceunit": "RUB", "value": 94.75}, {"coupondate": "2010-11-15", "faceunit": "RUB", "value": 52.93}, {"coupondate": "2011-05-15", "faceunit": "RUB", "value": 50.83}, {"coupondate": "2011-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2012-05-15", "faceunit": "RUB", "value": 53.6}, {"coupondate": "2012-11-15", "faceunit": "RUB", "value": 52.93}, {"coupondate": "2013-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2013-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2014-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2014-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2015-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2015-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2016-05-15", "faceunit": "RUB", "value": 53.6}, {"coupondate": "2016-11-15", "faceunit": "RUB", "value": 68.05}, {"coupondate": "2017-05-15", "faceunit": "RUB", "value": 61.99}, {"coupondate": "2017-11-15", "faceunit": "RUB", "value": 59.23}, {"coupondate": "2018-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2018-11-15", "faceunit": "RUB", "value": 49.15}, {"coupondate": "2019-05-15", "faceunit": "RUB", "value": 49.59}, {"coupondate": "2019-11-15", "faceunit": "RUB", "value": 51.67}, {"coupondate": "2020-05-15", "faceunit": "RUB", "value": 44.88}, {"coupondate": "2020-11-15", "faceunit": "RUB", "value": 40.33}, {"coupondate": "2021-05-15", "faceunit": "RUB", "value": 33.47}, {"coupondate": "2021-11-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-05-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-11-15", "faceunit": "RUB", "value": null}, {"coupondate": "2023-05-15", "faceunit": "RUB", "value": null}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}, {"SECID": "RU000A0JRJL7", "ISIN": "RU000A0JRJL7", "SHORTNAME": "\u0417\u0421\u0414 02", "SECNAME": "\u0417\u0430\u043f\u0430\u0434.\u0441\u043a\u043e\u0440.\u0434\u0438\u0430\u043c\u0435\u0442\u0440 \u0410\u041e \u043e\u0431.02", "PREVPRICE": 130, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2031-05-13", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 32.89, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "2423", "amortizations": [{"amortdate": "2031-05-13", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2011-12-06", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2012-06-05", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2012-12-04", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2013-06-04", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2013-12-03", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2014-06-03", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2014-12-02", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2015-06-02", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2015-12-01", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2016-05-31", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2016-11-29", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2017-05-30", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2017-11-28", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2018-05-29", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2018-11-27", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2019-05-28", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2019-11-26", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2020-05-26", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2020-11-24", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2021-05-25", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2021-11-23", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2022-05-24", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2022-11-22", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2023-05-23", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2023-11-21", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2024-05-21", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2024-11-19", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2025-05-20", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2025-11-18", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2026-05-19", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2026-11-17", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2027-05-18", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2027-11-16", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2028-05-16", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2028-11-14", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2029-05-15", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2029-11-13", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2030-05-14", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2030-11-12", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2031-05-13", "faceunit": "RUB", "value": 52.06}], "offers": [{"offerdate": "2016-06-02", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 3, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 3, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-15", "VOLUME": 6, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}]')
        output_bond_list = BondsMOEXFilter.filter_bonds_by_offer(input_bond_list)
        self.assertEqual(output_bond_list, target_bond_list)

    def test_filter_bonds_by_offer4(self):
        # List with 1 offer and 2 corrupt objects (without 'OFFERDATE')
        input_bond_list = json.loads('[{"SECID": "RU000A0JNYN1", "ISIN": "RU000A0JNYN1", "SHORTNAME": "\u041c\u0413\u043e\u044048-\u043e\u0431", "SECNAME": "\u0413\u043e\u0440.\u041e\u0431\u043b.\u0417\u0430\u0439\u043c \u041c\u043e\u0441\u043a\u0432\u044b 48 \u0432.", "PREVPRICE": 100.36, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-06-11", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 16.11, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "2067", "amortizations": [{"amortdate": "2022-06-11", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2007-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2007-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2009-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2009-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2010-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2010-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2011-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2011-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2013-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2013-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2014-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2014-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2015-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2015-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-06-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2017-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2017-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2018-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2018-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2019-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2019-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-06-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2021-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2021-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2022-06-11", "faceunit": "RUB", "value": 29.92}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 126, "NUMTRADES": 28}, {"TRADEDATE": "2021-03-04", "VOLUME": 124, "NUMTRADES": 19}, {"TRADEDATE": "2021-03-05", "VOLUME": 291, "NUMTRADES": 13}, {"TRADEDATE": "2021-03-09", "VOLUME": 186, "NUMTRADES": 34}, {"TRADEDATE": "2021-03-10", "VOLUME": 114, "NUMTRADES": 21}, {"TRADEDATE": "2021-03-11", "VOLUME": 28, "NUMTRADES": 15}, {"TRADEDATE": "2021-03-12", "VOLUME": 13, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-15", "VOLUME": 1235, "NUMTRADES": 82}, {"TRADEDATE": "2021-03-16", "VOLUME": 1992, "NUMTRADES": 41}, {"TRADEDATE": "2021-03-17", "VOLUME": 24, "NUMTRADES": 11}]}, {"SECID": "RU000A0JQ8V9", "ISIN": "RU000A0JQ8V9", "SHORTNAME": "\u041c\u0435\u0447\u0435\u043b  4\u043e\u0431", "SECNAME": "\u041c\u0435\u0447\u0435\u043b \u041f\u0410\u041e 04 \u043e\u0431\u043b.", "PREVPRICE": 252.06, "LOTSIZE": 1, "FACEVALUE": 100, "MATDATE": "2021-07-15", "FACEUNIT": "SUR", "ACCRUEDINT": 1.38, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "1483", "amortizations": [{"amortdate": "2016-08-11", "faceunit": "RUB", "value": 35}, {"amortdate": "2016-10-20", "faceunit": "RUB", "value": 35}, {"amortdate": "2017-01-19", "faceunit": "RUB", "value": 40}, {"amortdate": "2017-04-20", "faceunit": "RUB", "value": 40}, {"amortdate": "2017-07-20", "faceunit": "RUB", "value": 50}, {"amortdate": "2017-10-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-01-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-04-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-07-19", "faceunit": "RUB", "value": 50}, {"amortdate": "2018-10-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-01-17", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-04-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-07-18", "faceunit": "RUB", "value": 50}, {"amortdate": "2019-10-17", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-01-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-04-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-07-16", "faceunit": "RUB", "value": 50}, {"amortdate": "2020-10-15", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-01-14", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-04-15", "faceunit": "RUB", "value": 50}, {"amortdate": "2021-07-15", "faceunit": "RUB", "value": 50}], "coupons": [{"coupondate": "2009-10-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-01-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-04-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-07-29", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2010-10-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-01-27", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-04-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-07-28", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2011-10-27", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-01-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-04-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-07-26", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2012-10-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-01-24", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-04-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-07-25", "faceunit": "RUB", "value": 28.05}, {"coupondate": "2013-10-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-01-23", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-04-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-07-24", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2014-10-23", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2015-01-22", "faceunit": "RUB", "value": 32.41}, {"coupondate": "2015-04-23", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2015-07-23", "faceunit": "RUB", "value": 19.95}, {"coupondate": "2015-10-22", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-01-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-04-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-07-21", "faceunit": "RUB", "value": 4.99}, {"coupondate": "2016-10-20", "faceunit": "RUB", "value": 31.54}, {"coupondate": "2017-01-19", "faceunit": "RUB", "value": 28.98}, {"coupondate": "2017-04-20", "faceunit": "RUB", "value": 28.29}, {"coupondate": "2017-07-20", "faceunit": "RUB", "value": 26.75}, {"coupondate": "2017-10-19", "faceunit": "RUB", "value": 23.44}, {"coupondate": "2018-01-18", "faceunit": "RUB", "value": 21.5}, {"coupondate": "2018-04-19", "faceunit": "RUB", "value": 19.42}, {"coupondate": "2018-07-19", "faceunit": "RUB", "value": 17.62}, {"coupondate": "2018-10-18", "faceunit": "RUB", "value": 15.52}, {"coupondate": "2019-01-17", "faceunit": "RUB", "value": 14.4}, {"coupondate": "2019-04-18", "faceunit": "RUB", "value": 13.24}, {"coupondate": "2019-07-18", "faceunit": "RUB", "value": 11.92}, {"coupondate": "2019-10-17", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-01-16", "faceunit": "RUB", "value": 8.51}, {"coupondate": "2020-04-16", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2020-07-16", "faceunit": "RUB", "value": 5.77}, {"coupondate": "2020-10-15", "faceunit": "RUB", "value": 3.99}, {"coupondate": "2021-01-14", "faceunit": "RUB", "value": 2.95}, {"coupondate": "2021-04-15", "faceunit": "RUB", "value": 1.96}, {"coupondate": "2021-07-15", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2012-07-30", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2013-07-29", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2014-01-27", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2014-07-28", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2015-01-26", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}, {"offerdate": "2015-07-27", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 19, "NUMTRADES": 3}]}, {"SECID": "RU000A100YF3", "ISIN": "RU000A100YF3", "SHORTNAME": "\u041c\u0415\u0422\u0410\u041b\u0418\u041d\u041103", "SECNAME": "\u041c\u0415\u0422\u0410\u041b\u041b\u041e\u0418\u041d\u0412\u0415\u0421\u0422 \u0411\u041e-03", "PREVPRICE": 101, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2029-10-10", "FACEUNIT": "SUR", "ACCRUEDINT": 29.19, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "2539", "amortizations": [{"amortdate": "2029-10-10", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-04-22", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2020-10-21", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2021-04-21", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2021-10-20", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2022-04-20", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2022-10-19", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2023-04-19", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2023-10-18", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2024-04-17", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2024-10-16", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2025-04-16", "faceunit": "RUB", "value": 35.65}, {"coupondate": "2025-10-15", "faceunit": "RUB", "value": null}, {"coupondate": "2026-04-15", "faceunit": "RUB", "value": null}, {"coupondate": "2026-10-14", "faceunit": "RUB", "value": null}, {"coupondate": "2027-04-14", "faceunit": "RUB", "value": null}, {"coupondate": "2027-10-13", "faceunit": "RUB", "value": null}, {"coupondate": "2028-04-12", "faceunit": "RUB", "value": null}, {"coupondate": "2028-10-11", "faceunit": "RUB", "value": null}, {"coupondate": "2029-04-11", "faceunit": "RUB", "value": null}, {"coupondate": "2029-10-10", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2025-04-21", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 347, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 1471, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-09", "VOLUME": 34, "NUMTRADES": 5}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 15, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-17", "VOLUME": 10, "NUMTRADES": 1}]}, {"SECID": "RU000A0JQAL8", "ISIN": "RU000A0JQAL8", "SHORTNAME": "\u0414\u041e\u041c.\u0420\u042414\u043e\u0431", "SECNAME": "\u0414\u041e\u041c.\u0420\u0424 (\u0410\u041e) \u043e\u0431\u043b. \u0441\u0435\u0440. \u041014", "PREVPRICE": 104.7, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2023-05-15", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 22.93, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "1380", "amortizations": [{"amortdate": "2023-05-15", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2010-05-15", "faceunit": "RUB", "value": 94.75}, {"coupondate": "2010-11-15", "faceunit": "RUB", "value": 52.93}, {"coupondate": "2011-05-15", "faceunit": "RUB", "value": 50.83}, {"coupondate": "2011-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2012-05-15", "faceunit": "RUB", "value": 53.6}, {"coupondate": "2012-11-15", "faceunit": "RUB", "value": 52.93}, {"coupondate": "2013-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2013-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2014-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2014-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2015-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2015-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2016-05-15", "faceunit": "RUB", "value": 53.6}, {"coupondate": "2016-11-15", "faceunit": "RUB", "value": 68.05}, {"coupondate": "2017-05-15", "faceunit": "RUB", "value": 61.99}, {"coupondate": "2017-11-15", "faceunit": "RUB", "value": 59.23}, {"coupondate": "2018-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2018-11-15", "faceunit": "RUB", "value": 49.15}, {"coupondate": "2019-05-15", "faceunit": "RUB", "value": 49.59}, {"coupondate": "2019-11-15", "faceunit": "RUB", "value": 51.67}, {"coupondate": "2020-05-15", "faceunit": "RUB", "value": 44.88}, {"coupondate": "2020-11-15", "faceunit": "RUB", "value": 40.33}, {"coupondate": "2021-05-15", "faceunit": "RUB", "value": 33.47}, {"coupondate": "2021-11-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-05-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-11-15", "faceunit": "RUB", "value": null}, {"coupondate": "2023-05-15", "faceunit": "RUB", "value": null}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}, {"SECID": "RU000A0JRJL7", "ISIN": "RU000A0JRJL7", "SHORTNAME": "\u0417\u0421\u0414 02", "SECNAME": "\u0417\u0430\u043f\u0430\u0434.\u0441\u043a\u043e\u0440.\u0434\u0438\u0430\u043c\u0435\u0442\u0440 \u0410\u041e \u043e\u0431.02", "PREVPRICE": 130, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2031-05-13", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 32.89, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "2423", "amortizations": [{"amortdate": "2031-05-13", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2011-12-06", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2012-06-05", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2012-12-04", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2013-06-04", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2013-12-03", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2014-06-03", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2014-12-02", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2015-06-02", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2015-12-01", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2016-05-31", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2016-11-29", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2017-05-30", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2017-11-28", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2018-05-29", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2018-11-27", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2019-05-28", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2019-11-26", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2020-05-26", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2020-11-24", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2021-05-25", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2021-11-23", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2022-05-24", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2022-11-22", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2023-05-23", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2023-11-21", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2024-05-21", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2024-11-19", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2025-05-20", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2025-11-18", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2026-05-19", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2026-11-17", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2027-05-18", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2027-11-16", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2028-05-16", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2028-11-14", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2029-05-15", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2029-11-13", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2030-05-14", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2030-11-12", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2031-05-13", "faceunit": "RUB", "value": 52.06}], "offers": [{"offerdate": "2016-06-02", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 3, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 3, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-15", "VOLUME": 6, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}, {"SECID": "RU000A100Y50", "ISIN": "RU000A100Y50", "SHORTNAME": "\u0421\u0423\u042d\u041a-\u04241P4R", "SECNAME": "\u0421\u0423\u042d\u041a-\u0424\u0438\u043d\u0430\u043d\u0441 001\u0420-04R", "PREVPRICE": 103.03, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2029-10-08", "OFFERDATE": "2023-10-19", "FACEUNIT": "SUR", "ACCRUEDINT": 30.61, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "2337", "amortizations": [{"amortdate": "2029-10-08", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-04-20", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2020-10-19", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2021-04-19", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2021-10-18", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2022-04-18", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2022-10-17", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2023-04-17", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2023-10-16", "faceunit": "RUB", "value": 36.9}, {"coupondate": "2024-04-15", "faceunit": "RUB", "value": null}, {"coupondate": "2024-10-14", "faceunit": "RUB", "value": null}, {"coupondate": "2025-04-14", "faceunit": "RUB", "value": null}, {"coupondate": "2025-10-13", "faceunit": "RUB", "value": null}, {"coupondate": "2026-04-13", "faceunit": "RUB", "value": null}, {"coupondate": "2026-10-12", "faceunit": "RUB", "value": null}, {"coupondate": "2027-04-12", "faceunit": "RUB", "value": null}, {"coupondate": "2027-10-11", "faceunit": "RUB", "value": null}, {"coupondate": "2028-04-10", "faceunit": "RUB", "value": null}, {"coupondate": "2028-10-09", "faceunit": "RUB", "value": null}, {"coupondate": "2029-04-09", "faceunit": "RUB", "value": null}, {"coupondate": "2029-10-08", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2023-10-19", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 3, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-09", "VOLUME": 2, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-16", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}]')
        target_bond_list = json.loads('[{"SECID": "RU000A0JNYN1", "ISIN": "RU000A0JNYN1", "SHORTNAME": "\u041c\u0413\u043e\u044048-\u043e\u0431", "SECNAME": "\u0413\u043e\u0440.\u041e\u0431\u043b.\u0417\u0430\u0439\u043c \u041c\u043e\u0441\u043a\u0432\u044b 48 \u0432.", "PREVPRICE": 100.36, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-06-11", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 16.11, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "2067", "amortizations": [{"amortdate": "2022-06-11", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2007-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2007-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2008-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2009-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2009-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2010-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2010-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2011-06-11", "faceunit": "RUB", "value": 39.89}, {"coupondate": "2011-12-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-06-11", "faceunit": "RUB", "value": 40.11}, {"coupondate": "2012-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2013-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2013-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2014-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2014-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2015-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2015-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-06-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2016-12-11", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2017-06-11", "faceunit": "RUB", "value": 34.9}, {"coupondate": "2017-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2018-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2018-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2019-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2019-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-06-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2020-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2021-06-11", "faceunit": "RUB", "value": 29.92}, {"coupondate": "2021-12-11", "faceunit": "RUB", "value": 30.08}, {"coupondate": "2022-06-11", "faceunit": "RUB", "value": 29.92}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 126, "NUMTRADES": 28}, {"TRADEDATE": "2021-03-04", "VOLUME": 124, "NUMTRADES": 19}, {"TRADEDATE": "2021-03-05", "VOLUME": 291, "NUMTRADES": 13}, {"TRADEDATE": "2021-03-09", "VOLUME": 186, "NUMTRADES": 34}, {"TRADEDATE": "2021-03-10", "VOLUME": 114, "NUMTRADES": 21}, {"TRADEDATE": "2021-03-11", "VOLUME": 28, "NUMTRADES": 15}, {"TRADEDATE": "2021-03-12", "VOLUME": 13, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-15", "VOLUME": 1235, "NUMTRADES": 82}, {"TRADEDATE": "2021-03-16", "VOLUME": 1992, "NUMTRADES": 41}, {"TRADEDATE": "2021-03-17", "VOLUME": 24, "NUMTRADES": 11}]}, {"SECID": "RU000A0JQAL8", "ISIN": "RU000A0JQAL8", "SHORTNAME": "\u0414\u041e\u041c.\u0420\u042414\u043e\u0431", "SECNAME": "\u0414\u041e\u041c.\u0420\u0424 (\u0410\u041e) \u043e\u0431\u043b. \u0441\u0435\u0440. \u041014", "PREVPRICE": 104.7, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2023-05-15", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 22.93, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "1380", "amortizations": [{"amortdate": "2023-05-15", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2010-05-15", "faceunit": "RUB", "value": 94.75}, {"coupondate": "2010-11-15", "faceunit": "RUB", "value": 52.93}, {"coupondate": "2011-05-15", "faceunit": "RUB", "value": 50.83}, {"coupondate": "2011-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2012-05-15", "faceunit": "RUB", "value": 53.6}, {"coupondate": "2012-11-15", "faceunit": "RUB", "value": 52.93}, {"coupondate": "2013-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2013-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2014-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2014-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2015-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2015-11-15", "faceunit": "RUB", "value": 54.19}, {"coupondate": "2016-05-15", "faceunit": "RUB", "value": 53.6}, {"coupondate": "2016-11-15", "faceunit": "RUB", "value": 68.05}, {"coupondate": "2017-05-15", "faceunit": "RUB", "value": 61.99}, {"coupondate": "2017-11-15", "faceunit": "RUB", "value": 59.23}, {"coupondate": "2018-05-15", "faceunit": "RUB", "value": 53.31}, {"coupondate": "2018-11-15", "faceunit": "RUB", "value": 49.15}, {"coupondate": "2019-05-15", "faceunit": "RUB", "value": 49.59}, {"coupondate": "2019-11-15", "faceunit": "RUB", "value": 51.67}, {"coupondate": "2020-05-15", "faceunit": "RUB", "value": 44.88}, {"coupondate": "2020-11-15", "faceunit": "RUB", "value": 40.33}, {"coupondate": "2021-05-15", "faceunit": "RUB", "value": 33.47}, {"coupondate": "2021-11-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-05-15", "faceunit": "RUB", "value": null}, {"coupondate": "2022-11-15", "faceunit": "RUB", "value": null}, {"coupondate": "2023-05-15", "faceunit": "RUB", "value": null}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}, {"SECID": "RU000A0JRJL7", "ISIN": "RU000A0JRJL7", "SHORTNAME": "\u0417\u0421\u0414 02", "SECNAME": "\u0417\u0430\u043f\u0430\u0434.\u0441\u043a\u043e\u0440.\u0434\u0438\u0430\u043c\u0435\u0442\u0440 \u0410\u041e \u043e\u0431.02", "PREVPRICE": 130, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2031-05-13", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 32.89, "SECTYPE": "6", "ISQUALIFIEDINVESTORS": "0", "TYPE": "corporate_bond", "EMITTER_ID": "2423", "amortizations": [{"amortdate": "2031-05-13", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2011-12-06", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2012-06-05", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2012-12-04", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2013-06-04", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2013-12-03", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2014-06-03", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2014-12-02", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2015-06-02", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2015-12-01", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2016-05-31", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2016-11-29", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2017-05-30", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2017-11-28", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2018-05-29", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2018-11-27", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2019-05-28", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2019-11-26", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2020-05-26", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2020-11-24", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2021-05-25", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2021-11-23", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2022-05-24", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2022-11-22", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2023-05-23", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2023-11-21", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2024-05-21", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2024-11-19", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2025-05-20", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2025-11-18", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2026-05-19", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2026-11-17", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2027-05-18", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2027-11-16", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2028-05-16", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2028-11-14", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2029-05-15", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2029-11-13", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2030-05-14", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2030-11-12", "faceunit": "RUB", "value": 52.06}, {"coupondate": "2031-05-13", "faceunit": "RUB", "value": 52.06}], "offers": [{"offerdate": "2016-06-02", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-05", "VOLUME": 5, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 3, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 3, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-15", "VOLUME": 6, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}]')
        output_bond_list = BondsMOEXFilter.filter_bonds_by_offer(input_bond_list)
        self.assertEqual(output_bond_list, target_bond_list)

    def test_filter_bonds_by_amortization1(self):
        # Empty list
        input_bond_list = []
        target_bond_list = []
        output_bond_list = BondsMOEXFilter.filter_bonds_by_amortization(input_bond_list)
        self.assertEqual(output_bond_list, target_bond_list)

    def test_filter_bonds_by_amortization2(self):
        # List with no amortization at all
        input_bond_list = json.loads('[{"SECID": "RU000A0JXLM9", "ISIN": "RU000A0JXLM9", "SHORTNAME": "\u0418\u041d\u0413\u0420 \u0411\u041e-01", "SECNAME": "\u0418\u041d\u0413\u0420\u0410\u0414 \u041f\u0410\u041e \u0411\u041e-01", "PREVPRICE": 100.2, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-03-17", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 0.18, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "2167", "amortizations": [{"amortdate": "2022-03-17", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2017-09-21", "faceunit": "RUB", "value": 64.82}, {"coupondate": "2018-03-22", "faceunit": "RUB", "value": 57.34}, {"coupondate": "2018-09-20", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-03-21", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-09-19", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2020-03-19", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2020-09-17", "faceunit": "RUB", "value": 42.38}, {"coupondate": "2021-03-18", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2021-09-16", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2022-03-17", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2019-02-15", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2019-09-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-03-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-12-22", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 4, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 59, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 22, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 53, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-17", "VOLUME": 3, "NUMTRADES": 2}]},{"SECID": "RU000A100D30", "ISIN": "RU000A100D30", "SHORTNAME": "\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c03", "SECNAME": "\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c 03", "PREVPRICE": 100.91, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-08-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 10.43, "SECTYPE": "3", "ISQUALIFIEDINVESTORS": "0", "TYPE": "ofz_bond", "EMITTER_ID": "2389", "amortizations": [{"amortdate": "2022-08-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-02-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2020-08-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-02-03", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-08-04", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-02-02", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-08-03", "faceunit": "RUB", "value": 43.13}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 6467, "NUMTRADES": 410}, {"TRADEDATE": "2021-03-04", "VOLUME": 5023, "NUMTRADES": 383}, {"TRADEDATE": "2021-03-05", "VOLUME": 9443, "NUMTRADES": 345}, {"TRADEDATE": "2021-03-09", "VOLUME": 7430, "NUMTRADES": 444}, {"TRADEDATE": "2021-03-10", "VOLUME": 5676, "NUMTRADES": 307}, {"TRADEDATE": "2021-03-11", "VOLUME": 5497, "NUMTRADES": 430}, {"TRADEDATE": "2021-03-12", "VOLUME": 6633, "NUMTRADES": 369}, {"TRADEDATE": "2021-03-15", "VOLUME": 10516, "NUMTRADES": 615}, {"TRADEDATE": "2021-03-16", "VOLUME": 8365, "NUMTRADES": 437}, {"TRADEDATE": "2021-03-17", "VOLUME": 3205, "NUMTRADES": 380}]}, {"SECID": "RU000A100SF5", "ISIN": "RU000A100SF5", "SHORTNAME": "\u041c\u041a\u0411 \u041f04", "SECNAME": "\u041c\u041e\u0421\u041a\u041e\u0412\u0421\u041a\u0418\u0419 \u041a\u0420\u0415\u0414\u0418\u0422\u041d\u042b\u0419 \u0411\u0410\u041d\u041a \u041f04", "PREVPRICE": 95.65, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-09-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 18.89, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "1210", "amortizations": [{"amortdate": "2022-09-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-09-03", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2021-09-03", "faceunit": "RUB", "value": 35}, {"coupondate": "2022-09-03", "faceunit": "RUB", "value": 35}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 2, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-04", "VOLUME": 21, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 1850, "NUMTRADES": 90}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1109, "NUMTRADES": 265}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}]')
        target_bond_list = json.loads('[{"SECID": "RU000A0JXLM9", "ISIN": "RU000A0JXLM9", "SHORTNAME": "\u0418\u041d\u0413\u0420 \u0411\u041e-01", "SECNAME": "\u0418\u041d\u0413\u0420\u0410\u0414 \u041f\u0410\u041e \u0411\u041e-01", "PREVPRICE": 100.2, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-03-17", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 0.18, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "2167", "amortizations": [{"amortdate": "2022-03-17", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2017-09-21", "faceunit": "RUB", "value": 64.82}, {"coupondate": "2018-03-22", "faceunit": "RUB", "value": 57.34}, {"coupondate": "2018-09-20", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-03-21", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-09-19", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2020-03-19", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2020-09-17", "faceunit": "RUB", "value": 42.38}, {"coupondate": "2021-03-18", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2021-09-16", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2022-03-17", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2019-02-15", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2019-09-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-03-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-12-22", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 4, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 59, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 22, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 53, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-17", "VOLUME": 3, "NUMTRADES": 2}]},{"SECID": "RU000A100D30", "ISIN": "RU000A100D30", "SHORTNAME": "\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c03", "SECNAME": "\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c 03", "PREVPRICE": 100.91, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-08-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 10.43, "SECTYPE": "3", "ISQUALIFIEDINVESTORS": "0", "TYPE": "ofz_bond", "EMITTER_ID": "2389", "amortizations": [{"amortdate": "2022-08-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-02-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2020-08-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-02-03", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-08-04", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-02-02", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-08-03", "faceunit": "RUB", "value": 43.13}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 6467, "NUMTRADES": 410}, {"TRADEDATE": "2021-03-04", "VOLUME": 5023, "NUMTRADES": 383}, {"TRADEDATE": "2021-03-05", "VOLUME": 9443, "NUMTRADES": 345}, {"TRADEDATE": "2021-03-09", "VOLUME": 7430, "NUMTRADES": 444}, {"TRADEDATE": "2021-03-10", "VOLUME": 5676, "NUMTRADES": 307}, {"TRADEDATE": "2021-03-11", "VOLUME": 5497, "NUMTRADES": 430}, {"TRADEDATE": "2021-03-12", "VOLUME": 6633, "NUMTRADES": 369}, {"TRADEDATE": "2021-03-15", "VOLUME": 10516, "NUMTRADES": 615}, {"TRADEDATE": "2021-03-16", "VOLUME": 8365, "NUMTRADES": 437}, {"TRADEDATE": "2021-03-17", "VOLUME": 3205, "NUMTRADES": 380}]}, {"SECID": "RU000A100SF5", "ISIN": "RU000A100SF5", "SHORTNAME": "\u041c\u041a\u0411 \u041f04", "SECNAME": "\u041c\u041e\u0421\u041a\u041e\u0412\u0421\u041a\u0418\u0419 \u041a\u0420\u0415\u0414\u0418\u0422\u041d\u042b\u0419 \u0411\u0410\u041d\u041a \u041f04", "PREVPRICE": 95.65, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-09-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 18.89, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "1210", "amortizations": [{"amortdate": "2022-09-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-09-03", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2021-09-03", "faceunit": "RUB", "value": 35}, {"coupondate": "2022-09-03", "faceunit": "RUB", "value": 35}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 2, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-04", "VOLUME": 21, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 1850, "NUMTRADES": 90}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1109, "NUMTRADES": 265}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}]')
        output_bond_list = BondsMOEXFilter.filter_bonds_by_amortization(input_bond_list)
        self.assertEqual(output_bond_list, target_bond_list)

    def test_filter_bonds_by_amortization3(self):
        # List with no amortization or all amortization payments already passed
        input_bond_list = json.loads('[{"SECID": "RU000A0JVRM0", "ISIN": "RU000A0JVRM0", "SHORTNAME": "\u0411\u0430\u043b\u0442\u041b\u0438\u0437\u0411\u041e2", "SECNAME": "\u0411\u0430\u043b\u0442\u0438\u0439\u0441\u043a\u0438\u0439 \u043b\u0438\u0437\u0438\u043d\u0433 \u041e\u041e\u041e \u0411\u041e-02", "PREVPRICE": 100.25, "LOTSIZE": 1, "FACEVALUE": 500, "MATDATE": "2021-09-02", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 1.64, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "67656", "amortizations": [{"amortdate": "2017-09-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2017-12-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2018-03-08", "faceunit": "RUB", "value": 125}, {"amortdate": "2018-06-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2021-09-02", "faceunit": "RUB", "value": 500}], "coupons": [{"coupondate": "2015-12-10", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-03-10", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-06-09", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-09-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-12-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-03-09", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-06-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-09-07", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-12-07", "faceunit": "RUB", "value": 29.45}, {"coupondate": "2018-03-08", "faceunit": "RUB", "value": 25.24}, {"coupondate": "2018-06-07", "faceunit": "RUB", "value": 21.04}, {"coupondate": "2018-09-06", "faceunit": "RUB", "value": 16.83}, {"coupondate": "2018-12-06", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-03-07", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-06-06", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-09-05", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-12-05", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-03-05", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-06-04", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-09-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-12-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-03-04", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-06-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-09-02", "faceunit": "RUB", "value": 9.97}], "offers": [{"offerdate": "2018-09-06", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430/\u041f\u043e\u0433\u0430\u0448\u0435\u043d\u0438\u0435(\u043e\u0442\u043c\u0435\u043d\u0435\u043d\u043e)"}, {"offerdate": "2019-09-10", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 407, "NUMTRADES": 5}, {"TRADEDATE": "2021-03-09", "VOLUME": 4, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-10", "VOLUME": 90, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-11", "VOLUME": 55, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 8, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]},{"SECID": "RU000A0JXLM9", "ISIN": "RU000A0JXLM9", "SHORTNAME": "\u0418\u041d\u0413\u0420 \u0411\u041e-01", "SECNAME": "\u0418\u041d\u0413\u0420\u0410\u0414 \u041f\u0410\u041e \u0411\u041e-01", "PREVPRICE": 100.2, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-03-17", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 0.18, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "2167", "amortizations": [{"amortdate": "2022-03-17", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2017-09-21", "faceunit": "RUB", "value": 64.82}, {"coupondate": "2018-03-22", "faceunit": "RUB", "value": 57.34}, {"coupondate": "2018-09-20", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-03-21", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-09-19", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2020-03-19", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2020-09-17", "faceunit": "RUB", "value": 42.38}, {"coupondate": "2021-03-18", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2021-09-16", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2022-03-17", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2019-02-15", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2019-09-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-03-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-12-22", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 4, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 59, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 22, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 53, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-17", "VOLUME": 3, "NUMTRADES": 2}]},{"SECID": "RU000A100D30", "ISIN": "RU000A100D30", "SHORTNAME": "\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c03", "SECNAME": "\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c 03", "PREVPRICE": 100.91, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-08-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 10.43, "SECTYPE": "3", "ISQUALIFIEDINVESTORS": "0", "TYPE": "ofz_bond", "EMITTER_ID": "2389", "amortizations": [{"amortdate": "2022-08-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-02-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2020-08-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-02-03", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-08-04", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-02-02", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-08-03", "faceunit": "RUB", "value": 43.13}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 6467, "NUMTRADES": 410}, {"TRADEDATE": "2021-03-04", "VOLUME": 5023, "NUMTRADES": 383}, {"TRADEDATE": "2021-03-05", "VOLUME": 9443, "NUMTRADES": 345}, {"TRADEDATE": "2021-03-09", "VOLUME": 7430, "NUMTRADES": 444}, {"TRADEDATE": "2021-03-10", "VOLUME": 5676, "NUMTRADES": 307}, {"TRADEDATE": "2021-03-11", "VOLUME": 5497, "NUMTRADES": 430}, {"TRADEDATE": "2021-03-12", "VOLUME": 6633, "NUMTRADES": 369}, {"TRADEDATE": "2021-03-15", "VOLUME": 10516, "NUMTRADES": 615}, {"TRADEDATE": "2021-03-16", "VOLUME": 8365, "NUMTRADES": 437}, {"TRADEDATE": "2021-03-17", "VOLUME": 3205, "NUMTRADES": 380}]}]')
        target_bond_list = json.loads('[{"SECID": "RU000A0JVRM0", "ISIN": "RU000A0JVRM0", "SHORTNAME": "\u0411\u0430\u043b\u0442\u041b\u0438\u0437\u0411\u041e2", "SECNAME": "\u0411\u0430\u043b\u0442\u0438\u0439\u0441\u043a\u0438\u0439 \u043b\u0438\u0437\u0438\u043d\u0433 \u041e\u041e\u041e \u0411\u041e-02", "PREVPRICE": 100.25, "LOTSIZE": 1, "FACEVALUE": 500, "MATDATE": "2021-09-02", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 1.64, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "67656", "amortizations": [{"amortdate": "2017-09-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2017-12-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2018-03-08", "faceunit": "RUB", "value": 125}, {"amortdate": "2018-06-07", "faceunit": "RUB", "value": 125}, {"amortdate": "2021-09-02", "faceunit": "RUB", "value": 500}], "coupons": [{"coupondate": "2015-12-10", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-03-10", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-06-09", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-09-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2016-12-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-03-09", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-06-08", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-09-07", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2017-12-07", "faceunit": "RUB", "value": 29.45}, {"coupondate": "2018-03-08", "faceunit": "RUB", "value": 25.24}, {"coupondate": "2018-06-07", "faceunit": "RUB", "value": 21.04}, {"coupondate": "2018-09-06", "faceunit": "RUB", "value": 16.83}, {"coupondate": "2018-12-06", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-03-07", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-06-06", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-09-05", "faceunit": "RUB", "value": 13.09}, {"coupondate": "2019-12-05", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-03-05", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-06-04", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-09-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2020-12-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-03-04", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-06-03", "faceunit": "RUB", "value": 9.97}, {"coupondate": "2021-09-02", "faceunit": "RUB", "value": 9.97}], "offers": [{"offerdate": "2018-09-06", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430/\u041f\u043e\u0433\u0430\u0448\u0435\u043d\u0438\u0435(\u043e\u0442\u043c\u0435\u043d\u0435\u043d\u043e)"}, {"offerdate": "2019-09-10", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 407, "NUMTRADES": 5}, {"TRADEDATE": "2021-03-09", "VOLUME": 4, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-10", "VOLUME": 90, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-11", "VOLUME": 55, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-16", "VOLUME": 8, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]},{"SECID": "RU000A0JXLM9", "ISIN": "RU000A0JXLM9", "SHORTNAME": "\u0418\u041d\u0413\u0420 \u0411\u041e-01", "SECNAME": "\u0418\u041d\u0413\u0420\u0410\u0414 \u041f\u0410\u041e \u0411\u041e-01", "PREVPRICE": 100.2, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-03-17", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 0.18, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "2167", "amortizations": [{"amortdate": "2022-03-17", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2017-09-21", "faceunit": "RUB", "value": 64.82}, {"coupondate": "2018-03-22", "faceunit": "RUB", "value": 57.34}, {"coupondate": "2018-09-20", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-03-21", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-09-19", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2020-03-19", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2020-09-17", "faceunit": "RUB", "value": 42.38}, {"coupondate": "2021-03-18", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2021-09-16", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2022-03-17", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2019-02-15", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2019-09-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-03-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-12-22", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 4, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 59, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 22, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 53, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-17", "VOLUME": 3, "NUMTRADES": 2}]},{"SECID": "RU000A100D30", "ISIN": "RU000A100D30", "SHORTNAME": "\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c03", "SECNAME": "\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c 03", "PREVPRICE": 100.91, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-08-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 10.43, "SECTYPE": "3", "ISQUALIFIEDINVESTORS": "0", "TYPE": "ofz_bond", "EMITTER_ID": "2389", "amortizations": [{"amortdate": "2022-08-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-02-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2020-08-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-02-03", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-08-04", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-02-02", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-08-03", "faceunit": "RUB", "value": 43.13}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 6467, "NUMTRADES": 410}, {"TRADEDATE": "2021-03-04", "VOLUME": 5023, "NUMTRADES": 383}, {"TRADEDATE": "2021-03-05", "VOLUME": 9443, "NUMTRADES": 345}, {"TRADEDATE": "2021-03-09", "VOLUME": 7430, "NUMTRADES": 444}, {"TRADEDATE": "2021-03-10", "VOLUME": 5676, "NUMTRADES": 307}, {"TRADEDATE": "2021-03-11", "VOLUME": 5497, "NUMTRADES": 430}, {"TRADEDATE": "2021-03-12", "VOLUME": 6633, "NUMTRADES": 369}, {"TRADEDATE": "2021-03-15", "VOLUME": 10516, "NUMTRADES": 615}, {"TRADEDATE": "2021-03-16", "VOLUME": 8365, "NUMTRADES": 437}, {"TRADEDATE": "2021-03-17", "VOLUME": 3205, "NUMTRADES": 380}]}]')
        output_bond_list = BondsMOEXFilter.filter_bonds_by_amortization(input_bond_list)
        self.assertEqual(output_bond_list, target_bond_list)

    def test_filter_bonds_by_amortization4(self):
        # List with 2 amortization
        input_bond_list = json.loads('[{"SECID": "RU000A0JXLM9", "ISIN": "RU000A0JXLM9", "SHORTNAME": "\u0418\u041d\u0413\u0420 \u0411\u041e-01", "SECNAME": "\u0418\u041d\u0413\u0420\u0410\u0414 \u041f\u0410\u041e \u0411\u041e-01", "PREVPRICE": 100.2, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-03-17", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 0.18, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "2167", "amortizations": [{"amortdate": "2022-03-17", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2017-09-21", "faceunit": "RUB", "value": 64.82}, {"coupondate": "2018-03-22", "faceunit": "RUB", "value": 57.34}, {"coupondate": "2018-09-20", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-03-21", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-09-19", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2020-03-19", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2020-09-17", "faceunit": "RUB", "value": 42.38}, {"coupondate": "2021-03-18", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2021-09-16", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2022-03-17", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2019-02-15", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2019-09-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-03-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-12-22", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 4, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 59, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 22, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 53, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-17", "VOLUME": 3, "NUMTRADES": 2}]}, {"SECID": "RU000A0JX0Z8", "ISIN": "RU000A0JX0Z8", "SHORTNAME": "\u042f\u041d\u0410\u041e-2016", "SECNAME": "\u042f\u043c\u0430\u043b\u043e-\u041d\u0435\u043d\u0435\u0446\u043a\u0438\u0439 \u0410\u041e \u043e\u0431 2016", "PREVPRICE": 104.01, "LOTSIZE": 1, "FACEVALUE": 300, "MATDATE": "2023-12-06", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 1.23, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "1406", "amortizations": [{"amortdate": "2018-12-05", "faceunit": "RUB", "value": 400}, {"amortdate": "2020-12-02", "faceunit": "RUB", "value": 300}, {"amortdate": "2021-12-01", "faceunit": "RUB", "value": 150}, {"amortdate": "2022-11-30", "faceunit": "RUB", "value": 100}, {"amortdate": "2023-12-06", "faceunit": "RUB", "value": 50}], "coupons": [{"coupondate": "2017-03-08", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2017-06-07", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2017-09-06", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2017-12-06", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2018-03-07", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2018-06-06", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2018-09-05", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2018-12-05", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2019-03-06", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2019-06-05", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2019-09-04", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2019-12-04", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2020-03-04", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2020-06-03", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2020-09-02", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2020-12-02", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2021-03-03", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2021-06-02", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2021-09-01", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2021-12-01", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2022-03-02", "faceunit": "RUB", "value": 3.5}, {"coupondate": "2022-06-01", "faceunit": "RUB", "value": 3.5}, {"coupondate": "2022-08-31", "faceunit": "RUB", "value": 3.5}, {"coupondate": "2022-11-30", "faceunit": "RUB", "value": 3.5}, {"coupondate": "2023-03-01", "faceunit": "RUB", "value": 1.17}, {"coupondate": "2023-05-31", "faceunit": "RUB", "value": 1.17}, {"coupondate": "2023-08-30", "faceunit": "RUB", "value": 1.17}, {"coupondate": "2023-12-06", "faceunit": "RUB", "value": 1.26}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 516, "NUMTRADES": 88}, {"TRADEDATE": "2021-03-04", "VOLUME": 1880, "NUMTRADES": 86}, {"TRADEDATE": "2021-03-05", "VOLUME": 1716, "NUMTRADES": 166}, {"TRADEDATE": "2021-03-09", "VOLUME": 577, "NUMTRADES": 110}, {"TRADEDATE": "2021-03-10", "VOLUME": 714, "NUMTRADES": 119}, {"TRADEDATE": "2021-03-11", "VOLUME": 1347, "NUMTRADES": 112}, {"TRADEDATE": "2021-03-12", "VOLUME": 182, "NUMTRADES": 82}, {"TRADEDATE": "2021-03-15", "VOLUME": 376, "NUMTRADES": 81}, {"TRADEDATE": "2021-03-16", "VOLUME": 230, "NUMTRADES": 73}, {"TRADEDATE": "2021-03-17", "VOLUME": 496, "NUMTRADES": 108}]}, {"SECID": "RU000A100D30", "ISIN": "RU000A100D30", "SHORTNAME": "\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c03", "SECNAME": "\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c 03", "PREVPRICE": 100.91, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-08-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 10.43, "SECTYPE": "3", "ISQUALIFIEDINVESTORS": "0", "TYPE": "ofz_bond", "EMITTER_ID": "2389", "amortizations": [{"amortdate": "2022-08-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-02-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2020-08-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-02-03", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-08-04", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-02-02", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-08-03", "faceunit": "RUB", "value": 43.13}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 6467, "NUMTRADES": 410}, {"TRADEDATE": "2021-03-04", "VOLUME": 5023, "NUMTRADES": 383}, {"TRADEDATE": "2021-03-05", "VOLUME": 9443, "NUMTRADES": 345}, {"TRADEDATE": "2021-03-09", "VOLUME": 7430, "NUMTRADES": 444}, {"TRADEDATE": "2021-03-10", "VOLUME": 5676, "NUMTRADES": 307}, {"TRADEDATE": "2021-03-11", "VOLUME": 5497, "NUMTRADES": 430}, {"TRADEDATE": "2021-03-12", "VOLUME": 6633, "NUMTRADES": 369}, {"TRADEDATE": "2021-03-15", "VOLUME": 10516, "NUMTRADES": 615}, {"TRADEDATE": "2021-03-16", "VOLUME": 8365, "NUMTRADES": 437}, {"TRADEDATE": "2021-03-17", "VOLUME": 3205, "NUMTRADES": 380}]}, {"SECID": "RU000A100SF5", "ISIN": "RU000A100SF5", "SHORTNAME": "\u041c\u041a\u0411 \u041f04", "SECNAME": "\u041c\u041e\u0421\u041a\u041e\u0412\u0421\u041a\u0418\u0419 \u041a\u0420\u0415\u0414\u0418\u0422\u041d\u042b\u0419 \u0411\u0410\u041d\u041a \u041f04", "PREVPRICE": 95.65, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-09-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 18.89, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "1210", "amortizations": [{"amortdate": "2022-09-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-09-03", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2021-09-03", "faceunit": "RUB", "value": 35}, {"coupondate": "2022-09-03", "faceunit": "RUB", "value": 35}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 2, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-04", "VOLUME": 21, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 1850, "NUMTRADES": 90}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1109, "NUMTRADES": 265}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}, {"SECID": "RU000A101XE6", "ISIN": "RU000A101XE6", "SHORTNAME": "\u0421\u043e\u0432\u043a\u043c\u041b \u041f02", "SECNAME": "\u0421\u043e\u0432\u043a\u043e\u043c\u0431\u0430\u043d\u043a \u041b\u0438\u0437\u0438\u043d\u0433 \u0411\u041e-\u041f02", "PREVPRICE": 99.61, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2023-07-18", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 10.67, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "997857", "amortizations": [{"amortdate": "2022-04-19", "faceunit": "RUB", "value": 150}, {"amortdate": "2022-07-19", "faceunit": "RUB", "value": 150}, {"amortdate": "2022-10-18", "faceunit": "RUB", "value": 150}, {"amortdate": "2023-01-17", "faceunit": "RUB", "value": 150}, {"amortdate": "2023-04-18", "faceunit": "RUB", "value": 150}, {"amortdate": "2023-07-18", "faceunit": "RUB", "value": 250}], "coupons": [{"coupondate": "2020-10-20", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2021-01-19", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2021-04-20", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2021-07-20", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2021-10-19", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2022-01-18", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2022-04-19", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2022-07-19", "faceunit": "RUB", "value": 13.99}, {"coupondate": "2022-10-18", "faceunit": "RUB", "value": 11.52}, {"coupondate": "2023-01-17", "faceunit": "RUB", "value": 9.05}, {"coupondate": "2023-04-18", "faceunit": "RUB", "value": 6.58}, {"coupondate": "2023-07-18", "faceunit": "RUB", "value": 4.11}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-04", "VOLUME": 130, "NUMTRADES": 6}, {"TRADEDATE": "2021-03-05", "VOLUME": 7, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-09", "VOLUME": 50, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-10", "VOLUME": 54, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-11", "VOLUME": 8, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-12", "VOLUME": 2, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-15", "VOLUME": 74, "NUMTRADES": 9}, {"TRADEDATE": "2021-03-16", "VOLUME": 998, "NUMTRADES": 6}, {"TRADEDATE": "2021-03-17", "VOLUME": 18, "NUMTRADES": 5}]}]')
        target_bond_list = json.loads('[{"SECID": "RU000A0JXLM9", "ISIN": "RU000A0JXLM9", "SHORTNAME": "\u0418\u041d\u0413\u0420 \u0411\u041e-01", "SECNAME": "\u0418\u041d\u0413\u0420\u0410\u0414 \u041f\u0410\u041e \u0411\u041e-01", "PREVPRICE": 100.2, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-03-17", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 0.18, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "2167", "amortizations": [{"amortdate": "2022-03-17", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2017-09-21", "faceunit": "RUB", "value": 64.82}, {"coupondate": "2018-03-22", "faceunit": "RUB", "value": 57.34}, {"coupondate": "2018-09-20", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-03-21", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-09-19", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2020-03-19", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2020-09-17", "faceunit": "RUB", "value": 42.38}, {"coupondate": "2021-03-18", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2021-09-16", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2022-03-17", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2019-02-15", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2019-09-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-03-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-12-22", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 4, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 59, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 22, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 53, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-17", "VOLUME": 3, "NUMTRADES": 2}]},{"SECID": "RU000A100D30", "ISIN": "RU000A100D30", "SHORTNAME": "\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c03", "SECNAME": "\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c 03", "PREVPRICE": 100.91, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-08-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 10.43, "SECTYPE": "3", "ISQUALIFIEDINVESTORS": "0", "TYPE": "ofz_bond", "EMITTER_ID": "2389", "amortizations": [{"amortdate": "2022-08-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-02-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2020-08-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-02-03", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-08-04", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-02-02", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-08-03", "faceunit": "RUB", "value": 43.13}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 6467, "NUMTRADES": 410}, {"TRADEDATE": "2021-03-04", "VOLUME": 5023, "NUMTRADES": 383}, {"TRADEDATE": "2021-03-05", "VOLUME": 9443, "NUMTRADES": 345}, {"TRADEDATE": "2021-03-09", "VOLUME": 7430, "NUMTRADES": 444}, {"TRADEDATE": "2021-03-10", "VOLUME": 5676, "NUMTRADES": 307}, {"TRADEDATE": "2021-03-11", "VOLUME": 5497, "NUMTRADES": 430}, {"TRADEDATE": "2021-03-12", "VOLUME": 6633, "NUMTRADES": 369}, {"TRADEDATE": "2021-03-15", "VOLUME": 10516, "NUMTRADES": 615}, {"TRADEDATE": "2021-03-16", "VOLUME": 8365, "NUMTRADES": 437}, {"TRADEDATE": "2021-03-17", "VOLUME": 3205, "NUMTRADES": 380}]}, {"SECID": "RU000A100SF5", "ISIN": "RU000A100SF5", "SHORTNAME": "\u041c\u041a\u0411 \u041f04", "SECNAME": "\u041c\u041e\u0421\u041a\u041e\u0412\u0421\u041a\u0418\u0419 \u041a\u0420\u0415\u0414\u0418\u0422\u041d\u042b\u0419 \u0411\u0410\u041d\u041a \u041f04", "PREVPRICE": 95.65, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-09-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 18.89, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "1210", "amortizations": [{"amortdate": "2022-09-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-09-03", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2021-09-03", "faceunit": "RUB", "value": 35}, {"coupondate": "2022-09-03", "faceunit": "RUB", "value": 35}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 2, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-04", "VOLUME": 21, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 1850, "NUMTRADES": 90}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1109, "NUMTRADES": 265}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}]')
        output_bond_list = BondsMOEXFilter.filter_bonds_by_amortization(input_bond_list)
        self.assertEqual(output_bond_list, target_bond_list)

    def test_filter_bonds_by_amortization5(self):
        # List with 1 amortization and 2 corrupt objects (without 'amortization')
        input_bond_list = json.loads('[{"SECID": "RU000A0JXLM9", "ISIN": "RU000A0JXLM9", "SHORTNAME": "\u0418\u041d\u0413\u0420 \u0411\u041e-01", "SECNAME": "\u0418\u041d\u0413\u0420\u0410\u0414 \u041f\u0410\u041e \u0411\u041e-01", "PREVPRICE": 100.2, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-03-17", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 0.18, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "2167", "coupons": [{"coupondate": "2017-09-21", "faceunit": "RUB", "value": 64.82}, {"coupondate": "2018-03-22", "faceunit": "RUB", "value": 57.34}, {"coupondate": "2018-09-20", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-03-21", "faceunit": "RUB", "value": 52.36}, {"coupondate": "2019-09-19", "faceunit": "RUB", "value": 47.37}, {"coupondate": "2020-03-19", "faceunit": "RUB", "value": 43.63}, {"coupondate": "2020-09-17", "faceunit": "RUB", "value": 42.38}, {"coupondate": "2021-03-18", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2021-09-16", "faceunit": "RUB", "value": 33.66}, {"coupondate": "2022-03-17", "faceunit": "RUB", "value": null}], "offers": [{"offerdate": "2019-02-15", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2019-09-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-03-24", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430"}, {"offerdate": "2020-12-22", "offertype": "\u041e\u0444\u0435\u0440\u0442\u0430 (\u0441\u043e\u0441\u0442\u043e\u044f\u043b\u043e\u0441\u044c)"}], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-04", "VOLUME": 4, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 59, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 22, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-16", "VOLUME": 53, "NUMTRADES": 8}, {"TRADEDATE": "2021-03-17", "VOLUME": 3, "NUMTRADES": 2}]}, {"SECID": "RU000A0JX0Z8", "ISIN": "RU000A0JX0Z8", "SHORTNAME": "\u042f\u041d\u0410\u041e-2016", "SECNAME": "\u042f\u043c\u0430\u043b\u043e-\u041d\u0435\u043d\u0435\u0446\u043a\u0438\u0439 \u0410\u041e \u043e\u0431 2016", "PREVPRICE": 104.01, "LOTSIZE": 1, "FACEVALUE": 300, "MATDATE": "2023-12-06", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 1.23, "SECTYPE": "4", "ISQUALIFIEDINVESTORS": "0", "TYPE": "subfederal_bond", "EMITTER_ID": "1406", "amortizations": [{"amortdate": "2018-12-05", "faceunit": "RUB", "value": 400}, {"amortdate": "2020-12-02", "faceunit": "RUB", "value": 300}, {"amortdate": "2021-12-01", "faceunit": "RUB", "value": 150}, {"amortdate": "2022-11-30", "faceunit": "RUB", "value": 100}, {"amortdate": "2023-12-06", "faceunit": "RUB", "value": 50}], "coupons": [{"coupondate": "2017-03-08", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2017-06-07", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2017-09-06", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2017-12-06", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2018-03-07", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2018-06-06", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2018-09-05", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2018-12-05", "faceunit": "RUB", "value": 23.36}, {"coupondate": "2019-03-06", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2019-06-05", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2019-09-04", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2019-12-04", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2020-03-04", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2020-06-03", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2020-09-02", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2020-12-02", "faceunit": "RUB", "value": 14.02}, {"coupondate": "2021-03-03", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2021-06-02", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2021-09-01", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2021-12-01", "faceunit": "RUB", "value": 7.01}, {"coupondate": "2022-03-02", "faceunit": "RUB", "value": 3.5}, {"coupondate": "2022-06-01", "faceunit": "RUB", "value": 3.5}, {"coupondate": "2022-08-31", "faceunit": "RUB", "value": 3.5}, {"coupondate": "2022-11-30", "faceunit": "RUB", "value": 3.5}, {"coupondate": "2023-03-01", "faceunit": "RUB", "value": 1.17}, {"coupondate": "2023-05-31", "faceunit": "RUB", "value": 1.17}, {"coupondate": "2023-08-30", "faceunit": "RUB", "value": 1.17}, {"coupondate": "2023-12-06", "faceunit": "RUB", "value": 1.26}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 516, "NUMTRADES": 88}, {"TRADEDATE": "2021-03-04", "VOLUME": 1880, "NUMTRADES": 86}, {"TRADEDATE": "2021-03-05", "VOLUME": 1716, "NUMTRADES": 166}, {"TRADEDATE": "2021-03-09", "VOLUME": 577, "NUMTRADES": 110}, {"TRADEDATE": "2021-03-10", "VOLUME": 714, "NUMTRADES": 119}, {"TRADEDATE": "2021-03-11", "VOLUME": 1347, "NUMTRADES": 112}, {"TRADEDATE": "2021-03-12", "VOLUME": 182, "NUMTRADES": 82}, {"TRADEDATE": "2021-03-15", "VOLUME": 376, "NUMTRADES": 81}, {"TRADEDATE": "2021-03-16", "VOLUME": 230, "NUMTRADES": 73}, {"TRADEDATE": "2021-03-17", "VOLUME": 496, "NUMTRADES": 108}]}, {"SECID": "RU000A100D30", "ISIN": "RU000A100D30", "SHORTNAME": "\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c03", "SECNAME": "\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c 03", "PREVPRICE": 100.91, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-08-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 10.43, "SECTYPE": "3", "ISQUALIFIEDINVESTORS": "0", "TYPE": "ofz_bond", "EMITTER_ID": "2389", "amortizations": [{"amortdate": "2022-08-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-02-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2020-08-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-02-03", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-08-04", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-02-02", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-08-03", "faceunit": "RUB", "value": 43.13}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 6467, "NUMTRADES": 410}, {"TRADEDATE": "2021-03-04", "VOLUME": 5023, "NUMTRADES": 383}, {"TRADEDATE": "2021-03-05", "VOLUME": 9443, "NUMTRADES": 345}, {"TRADEDATE": "2021-03-09", "VOLUME": 7430, "NUMTRADES": 444}, {"TRADEDATE": "2021-03-10", "VOLUME": 5676, "NUMTRADES": 307}, {"TRADEDATE": "2021-03-11", "VOLUME": 5497, "NUMTRADES": 430}, {"TRADEDATE": "2021-03-12", "VOLUME": 6633, "NUMTRADES": 369}, {"TRADEDATE": "2021-03-15", "VOLUME": 10516, "NUMTRADES": 615}, {"TRADEDATE": "2021-03-16", "VOLUME": 8365, "NUMTRADES": 437}, {"TRADEDATE": "2021-03-17", "VOLUME": 3205, "NUMTRADES": 380}]}, {"SECID": "RU000A100SF5", "ISIN": "RU000A100SF5", "SHORTNAME": "\u041c\u041a\u0411 \u041f04", "SECNAME": "\u041c\u041e\u0421\u041a\u041e\u0412\u0421\u041a\u0418\u0419 \u041a\u0420\u0415\u0414\u0418\u0422\u041d\u042b\u0419 \u0411\u0410\u041d\u041a \u041f04", "PREVPRICE": 95.65, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-09-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 18.89, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "1210", "amortizations": [{"amortdate": "2022-09-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-09-03", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2021-09-03", "faceunit": "RUB", "value": 35}, {"coupondate": "2022-09-03", "faceunit": "RUB", "value": 35}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 2, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-04", "VOLUME": 21, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 1850, "NUMTRADES": 90}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1109, "NUMTRADES": 265}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}, {"SECID": "RU000A101XE6", "ISIN": "RU000A101XE6", "SHORTNAME": "\u0421\u043e\u0432\u043a\u043c\u041b \u041f02", "SECNAME": "\u0421\u043e\u0432\u043a\u043e\u043c\u0431\u0430\u043d\u043a \u041b\u0438\u0437\u0438\u043d\u0433 \u0411\u041e-\u041f02", "PREVPRICE": 99.61, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2023-07-18", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 10.67, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "997857", "amortizations": [{"faceunit": "RUB", "value": 150}, {"amortdate": "2022-07-19", "faceunit": "RUB", "value": 150}, {"amortdate": "2022-10-18", "faceunit": "RUB", "value": 150}, {"amortdate": "2023-01-17", "faceunit": "RUB", "value": 150}, {"amortdate": "2023-04-18", "faceunit": "RUB", "value": 150}, {"amortdate": "2023-07-18", "faceunit": "RUB", "value": 250}], "coupons": [{"coupondate": "2020-10-20", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2021-01-19", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2021-04-20", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2021-07-20", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2021-10-19", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2022-01-18", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2022-04-19", "faceunit": "RUB", "value": 16.45}, {"coupondate": "2022-07-19", "faceunit": "RUB", "value": 13.99}, {"coupondate": "2022-10-18", "faceunit": "RUB", "value": 11.52}, {"coupondate": "2023-01-17", "faceunit": "RUB", "value": 9.05}, {"coupondate": "2023-04-18", "faceunit": "RUB", "value": 6.58}, {"coupondate": "2023-07-18", "faceunit": "RUB", "value": 4.11}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 1, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-04", "VOLUME": 130, "NUMTRADES": 6}, {"TRADEDATE": "2021-03-05", "VOLUME": 7, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-09", "VOLUME": 50, "NUMTRADES": 3}, {"TRADEDATE": "2021-03-10", "VOLUME": 54, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-11", "VOLUME": 8, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-12", "VOLUME": 2, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-15", "VOLUME": 74, "NUMTRADES": 9}, {"TRADEDATE": "2021-03-16", "VOLUME": 998, "NUMTRADES": 6}, {"TRADEDATE": "2021-03-17", "VOLUME": 18, "NUMTRADES": 5}]}]')
        target_bond_list = json.loads('[{"SECID": "RU000A100D30", "ISIN": "RU000A100D30", "SHORTNAME": "\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c03", "SECNAME": "\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c 03", "PREVPRICE": 100.91, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-08-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 10.43, "SECTYPE": "3", "ISQUALIFIEDINVESTORS": "0", "TYPE": "ofz_bond", "EMITTER_ID": "2389", "amortizations": [{"amortdate": "2022-08-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-02-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2020-08-05", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-02-03", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2021-08-04", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-02-02", "faceunit": "RUB", "value": 43.13}, {"coupondate": "2022-08-03", "faceunit": "RUB", "value": 43.13}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 6467, "NUMTRADES": 410}, {"TRADEDATE": "2021-03-04", "VOLUME": 5023, "NUMTRADES": 383}, {"TRADEDATE": "2021-03-05", "VOLUME": 9443, "NUMTRADES": 345}, {"TRADEDATE": "2021-03-09", "VOLUME": 7430, "NUMTRADES": 444}, {"TRADEDATE": "2021-03-10", "VOLUME": 5676, "NUMTRADES": 307}, {"TRADEDATE": "2021-03-11", "VOLUME": 5497, "NUMTRADES": 430}, {"TRADEDATE": "2021-03-12", "VOLUME": 6633, "NUMTRADES": 369}, {"TRADEDATE": "2021-03-15", "VOLUME": 10516, "NUMTRADES": 615}, {"TRADEDATE": "2021-03-16", "VOLUME": 8365, "NUMTRADES": 437}, {"TRADEDATE": "2021-03-17", "VOLUME": 3205, "NUMTRADES": 380}]}, {"SECID": "RU000A100SF5", "ISIN": "RU000A100SF5", "SHORTNAME": "\u041c\u041a\u0411 \u041f04", "SECNAME": "\u041c\u041e\u0421\u041a\u041e\u0412\u0421\u041a\u0418\u0419 \u041a\u0420\u0415\u0414\u0418\u0422\u041d\u042b\u0419 \u0411\u0410\u041d\u041a \u041f04", "PREVPRICE": 95.65, "LOTSIZE": 1, "FACEVALUE": 1000, "MATDATE": "2022-09-03", "OFFERDATE": null, "FACEUNIT": "SUR", "ACCRUEDINT": 18.89, "SECTYPE": "8", "ISQUALIFIEDINVESTORS": "0", "TYPE": "exchange_bond", "EMITTER_ID": "1210", "amortizations": [{"amortdate": "2022-09-03", "faceunit": "RUB", "value": 1000}], "coupons": [{"coupondate": "2020-09-03", "faceunit": "RUB", "value": 35.1}, {"coupondate": "2021-09-03", "faceunit": "RUB", "value": 35}, {"coupondate": "2022-09-03", "faceunit": "RUB", "value": 35}], "offers": [], "sales_history": [{"TRADEDATE": "2021-03-03", "VOLUME": 2, "NUMTRADES": 1}, {"TRADEDATE": "2021-03-04", "VOLUME": 21, "NUMTRADES": 4}, {"TRADEDATE": "2021-03-05", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-09", "VOLUME": 1850, "NUMTRADES": 90}, {"TRADEDATE": "2021-03-10", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-11", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-12", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-15", "VOLUME": 1109, "NUMTRADES": 265}, {"TRADEDATE": "2021-03-16", "VOLUME": 0, "NUMTRADES": 0}, {"TRADEDATE": "2021-03-17", "VOLUME": 0, "NUMTRADES": 0}]}]')
        output_bond_list = BondsMOEXFilter.filter_bonds_by_amortization(input_bond_list)
        self.assertEqual(output_bond_list, target_bond_list)


if __name__ == '__main__':
    unittest.main()
